"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.builderTypeParameter=void 0,exports.collectExtend=collectExtend,exports.hasTsNoCheckOrTsIgnoreFiles=exports.contextGlobal=exports.compilingEtsOrTsFiles=void 0,exports.isAnimateTo=isAnimateTo,exports.isExtendFunction=isExtendFunction,exports.isOriginalExtend=isOriginalExtend,exports.isResource=isResource,exports.processAnimateTo=processAnimateTo,exports.processResourceData=processResourceData,exports.processUISyntax=processUISyntax,exports.resetLog=resetLog,exports.transformLog=exports.resourceFileName=void 0,exports.validatorCard=validatorCard;var _typescript=_interopRequireDefault(require("typescript")),_path=_interopRequireDefault(require("path")),_fs=_interopRequireDefault(require("fs")),_pre_define=require("./pre_define"),_utils=require("./utils"),_process_module_files=require("./process_module_files"),_validate_ui_syntax=require("./validate_ui_syntax"),_process_component_class=require("./process_component_class"),_process_import=_interopRequireWildcard(require("./process_import")),_process_component_build=require("./process_component_build"),_component_map=require("./component_map"),_main=require("../main"),_process_component_member=require("./process_component_member"),_process_custom_component=require("./process_custom_component"),_module_source_file=require("./fast_build/ark_compiler/module/module_source_file");function _getRequireWildcardCache(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(_getRequireWildcardCache=function(e){return e?r:t})(e))}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=_getRequireWildcardCache(t);if(t&&t.has(e))return t.get(e);var r,a,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((a=i?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(o,r,a):o[r]=e[r]);return o.default=e,t&&t.set(e,o),o}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _newArrowCheck(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}const transformLog=new _utils.FileLog;exports.transformLog=transformLog;let contextGlobal,resourceFileName=(exports.contextGlobal=contextGlobal,"");exports.resourceFileName=resourceFileName;const builderTypeParameter={params:[]};exports.builderTypeParameter=builderTypeParameter;let hasTsNoCheckOrTsIgnoreFiles=[],compilingEtsOrTsFiles=(exports.hasTsNoCheckOrTsIgnoreFiles=hasTsNoCheckOrTsIgnoreFiles,[]);function processUISyntax(a,l=!1){var e=this;let d;return function(i){var n=this;_newArrowCheck(this,e),exports.contextGlobal=contextGlobal=i;let c;return function(e){var r=this,t=(_newArrowCheck(this,n),_typescript.default.hasTsNoCheckOrTsIgnoreFlag(e));if(compilingEtsOrTsFiles.push(_path.default.normalize(e.fileName)),c=_path.default.resolve(_path.default.dirname(e.fileName)),exports.resourceFileName=resourceFileName=_path.default.resolve(e.fileName),process.env.compiler===_pre_define.BUILD_ON||"rollup"===process.env.compileTool)if(_utils.storedFileInfo.transformCacheFiles[e.fileName]={mtimeMs:_fs.default.existsSync(e.fileName)?_fs.default.statSync(e.fileName).mtimeMs:0,children:[]},preprocessIdAttrs((transformLog.sourceFile=e).fileName),!l&&("moduleJson"!==process.env.compileMode&&_path.default.resolve(e.fileName)===_path.default.resolve(_main.projectConfig.projectPath,"app.ets")||/\.ts$/.test(e.fileName)))e=_typescript.default.visitEachChild(e,p,i),_main.projectConfig.compileMode===_pre_define.ESMODULE&&!0===_main.projectConfig.processTs&&(a=_typescript.default.getTypeExportImportAndConstEnumTransformer(i)(e),"rollup"===process.env.compileTool?t?hasTsNoCheckOrTsIgnoreFiles.push(_path.default.normalize(a.fileName)):_module_source_file.ModuleSourceFile.newSourceFile(_path.default.normalize(a.fileName),a):(0,_process_module_files.writeFileSyncByNode)(a,_main.projectConfig));else{var a=++_utils.componentInfo.id;e=createEntryNode(e=_typescript.default.visitEachChild(e,s,i),i,d,a),_component_map.GLOBAL_STYLE_FUNCTION.forEach(function(e,t){_newArrowCheck(this,r),_component_map.BUILDIN_STYLE_NAMES.delete(t)}.bind(this)),_component_map.GLOBAL_STYLE_FUNCTION.clear();const o=Array.from(e.statements);_main.partialUpdateConfig.partialUpdateMode||generateId(o,e),_component_map.INTERFACE_NODE_SET.forEach(function(e){_newArrowCheck(this,r),o.unshift(e)}.bind(this)),e=_typescript.default.factory.updateSourceFile(e,o),_component_map.INTERFACE_NODE_SET.clear(),_main.projectConfig.compileMode===_pre_define.ESMODULE&&!0===_main.projectConfig.processTs&&(a=_typescript.default.getTypeExportImportAndConstEnumTransformer(i)(e),"rollup"===process.env.compileTool?t?hasTsNoCheckOrTsIgnoreFiles.push(_path.default.normalize(a.fileName)):_module_source_file.ModuleSourceFile.newSourceFile(_path.default.normalize(a.fileName),a):(0,_process_module_files.writeFileSyncByNode)(a,_main.projectConfig))}return e}.bind(this);function s(e){var t,r=this;return"esmodule"===_main.projectConfig.compileMode&&"rollup"===process.env.compileTool&&_typescript.default.isImportDeclaration(e)?(0,_process_import.processImportModule)(e):"esmodule"===_main.projectConfig.compileMode&&"rollup"===process.env.compileTool||!(_typescript.default.isImportDeclaration(e)||_typescript.default.isImportEqualsDeclaration(e)||_typescript.default.isExportDeclaration(e)&&e.moduleSpecifier&&_typescript.default.isStringLiteral(e.moduleSpecifier))||(0,_process_import.default)(e,c,transformLog.errors),_typescript.default.isStructDeclaration(e)?(_validate_ui_syntax.componentCollection.currentClassName=e.name.getText(),_validate_ui_syntax.componentCollection.entryComponent===_validate_ui_syntax.componentCollection.currentClassName&&function(e){var t=this;e&&e.decorators&&e.decorators.length&&e.decorators.forEach(function(e){_newArrowCheck(this,t),e.expression&&_typescript.default.isCallExpression(e.expression)&&_typescript.default.isIdentifier(e.expression.expression)&&"Entry"===e.expression.expression.escapedText.toString()&&e.expression.arguments&&e.expression.arguments.length&&_typescript.default.isIdentifier(e.expression.arguments[0])&&(d=e.expression.arguments[0])}.bind(this)),d}(e),e=(0,_process_component_class.processComponentClass)(e,i,transformLog.errors,a),_validate_ui_syntax.componentCollection.currentClassName=null,_component_map.INNER_STYLE_FUNCTION.forEach(function(e,t){_newArrowCheck(this,r),_component_map.BUILDIN_STYLE_NAMES.delete(t)}.bind(this)),_component_map.INNER_STYLE_FUNCTION.clear()):_typescript.default.isFunctionDeclaration(e)?(0,_utils.hasDecorator)(e,_pre_define.COMPONENT_EXTEND_DECORATOR,null,transformLog.errors)?e=processExtend(e,transformLog.errors,_pre_define.COMPONENT_EXTEND_DECORATOR):(0,_utils.hasDecorator)(e,_pre_define.COMPONENT_BUILDER_DECORATOR)&&e.name&&e.body&&_typescript.default.isBlock(e.body)?(_component_map.CUSTOM_BUILDER_METHOD.add(e.name.getText()),builderTypeParameter.params=(0,_utils.getPossibleBuilderTypeParameter)(e.parameters),(t=_typescript.default.factory.createNodeArray(Array.from(e.parameters))).push((0,_process_component_class.createParentParameter)()),e=_typescript.default.factory.updateFunctionDeclaration(e,void 0,e.modifiers,e.asteriskToken,e.name,e.typeParameters,t,e.type,(0,_process_component_build.processComponentBlock)(e.body,!1,transformLog.errors,!1,!0,e.name.getText(),void 0,!0)),builderTypeParameter.params=[],e=(0,_process_component_class.processBuildMember)(e,i,transformLog.errors,!0)):(0,_utils.hasDecorator)(e,_pre_define.COMPONENT_STYLES_DECORATOR)?0===e.parameters.length?e=void 0:transformLog.errors.push({type:_utils.LogType.ERROR,message:"@Styles can't have parameters.",pos:e.getStart()}):(0,_utils.hasDecorator)(e,_pre_define.COMPONENT_CONCURRENT_DECORATOR)?e=processConcurrent(e):(0,_utils.hasDecorator)(e,_pre_define.COMPONENT_ANIMATABLE_EXTEND_DECORATOR,null,transformLog.errors)&&(e=processExtend(e,transformLog.errors,_pre_define.COMPONENT_ANIMATABLE_EXTEND_DECORATOR)):isResource(e)?e=processResourceData(e):isWorker(e)?e=processWorker(e):isAnimateTo(e)?e=processAnimateTo(e):isCustomDialogController(e)?e=createCustomDialogController(e.parent,e,transformLog.errors):(t=e).kind===_typescript.default.SyntaxKind.TypeReference&&t.typeName?.kind===_typescript.default.SyntaxKind.Identifier&&"ESObject"===t.typeName.escapedText&&(e=_typescript.default.factory.createKeywordTypeNode(_typescript.default.SyntaxKind.AnyKeyword)),_typescript.default.visitEachChild(e,s,i)}function p(e){return isResource(e)&&(e=processResourceData(e)),_typescript.default.visitEachChild(e,p,i)}}.bind(this)}function generateId(e,t){e.unshift(_typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define._GENERATE_ID),void 0,_typescript.default.factory.createKeywordTypeNode(_typescript.default.SyntaxKind.NumberKeyword),_typescript.default.factory.createNumericLiteral("0"))],_typescript.default.NodeFlags.Let)),_typescript.default.factory.createFunctionDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.GENERATE_ID),void 0,[],_typescript.default.factory.createKeywordTypeNode(_typescript.default.SyntaxKind.StringKeyword),_typescript.default.factory.createBlock([_typescript.default.factory.createReturnStatement(_typescript.default.factory.createBinaryExpression(_typescript.default.factory.createStringLiteral(_path.default.basename(t.fileName,_pre_define.EXTNAME_ETS)+"_"),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.PlusToken),_typescript.default.factory.createPrefixUnaryExpression(_typescript.default.SyntaxKind.PlusPlusToken,_typescript.default.factory.createIdentifier(_pre_define._GENERATE_ID))))],!0)))}function preprocessIdAttrs(e){for(var[t,r]of _component_map.ID_ATTRS)e===r.get("path")&&_component_map.ID_ATTRS.delete(t)}function isCustomDialogController(e){var t=e.parent;return!e.parent&&e.original&&(e.parent=e.original.parent),!!(_typescript.default.isNewExpression(e)&&e.expression&&_typescript.default.isIdentifier(e.expression)&&e.expression.escapedText.toString()===_pre_define.SET_CONTROLLER_CTR_TYPE)||(e.parent=t,!1)}function createCustomDialogController(r,e,a){var t,o=this;return e.arguments&&1===e.arguments.length&&_typescript.default.isObjectLiteralExpression(e.arguments[0])&&e.arguments[0].properties?(t=e.arguments[0].properties.map(function(e){_newArrowCheck(this,o);var t=isCustomDialogControllerPropertyAssignment(e,a);return e=null!==t?processCustomDialogControllerPropertyAssignment(r,e,t):e}.bind(this)),_typescript.default.factory.createNewExpression(e.expression,e.typeArguments,[_typescript.default.factory.createObjectLiteralExpression(t,!0),_typescript.default.factory.createThis()])):e}function isCustomDialogControllerPropertyAssignment(e,t){if(_typescript.default.isPropertyAssignment(e)&&_typescript.default.isIdentifier(e.name)&&e.name.getText()===_pre_define.CUSTOM_DIALOG_CONTROLLER_BUILDER)if(e.initializer){var r=(0,_process_component_build.getName)(e.initializer);if(_validate_ui_syntax.componentCollection.customDialogs.has(r))return r}else validateCustomDialogControllerBuilderInit(e,t);return null}function validateCustomDialogControllerBuilderInit(e,t){t.push({type:_utils.LogType.ERROR,message:"The builder should be initialized with a @CustomDialog Component.",pos:e.getStart()})}function processCustomDialogControllerPropertyAssignment(e,t,r){if(_typescript.default.isCallExpression(t.initializer))return _typescript.default.factory.updatePropertyAssignment(t,t.name,processCustomDialogControllerBuilder(e,t.initializer,r))}function processCustomDialogControllerBuilder(e,t,r){r=(0,_process_component_member.createCustomComponentNewExpression)(t,r,!1,!1,!0);return createCustomComponentBuilderArrowFunction(t,e,_typescript.default.factory.createIdentifier(_pre_define.JS_DIALOG),r)}function createCustomComponentBuilderArrowFunction(e,t,r,a){let o;return _typescript.default.isBinaryExpression(t)?o=t.left:(_typescript.default.isVariableDeclaration(t)||_typescript.default.isPropertyDeclaration(t))&&(o=_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),t.name)),_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([_main.partialUpdateConfig.partialUpdateMode?(0,_process_custom_component.assignComponentParams)(e):void 0,_typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(r,void 0,void 0,a)],_typescript.default.NodeFlags.Let)),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(r,_typescript.default.factory.createIdentifier(_pre_define.SET_CONTROLLER_METHOD)),void 0,o?[o]:void 0)),_typescript.default.factory.createExpressionStatement((0,_process_component_member.createViewCreate)(r))],!0))}function isResource(e){return _typescript.default.isCallExpression(e)&&_typescript.default.isIdentifier(e.expression)&&(e.expression.escapedText.toString()===_pre_define.RESOURCE||e.expression.escapedText.toString()===_pre_define.RESOURCE_RAWFILE)&&0<e.arguments.length}function isAnimateTo(e){return _typescript.default.isCallExpression(e)&&_typescript.default.isIdentifier(e.expression)&&e.expression.escapedText.toString()===_pre_define.ATTRIBUTE_ANIMATETO}function processResourceData(e,t={isAcceleratePreview:!1,log:[]}){return _typescript.default.isStringLiteral(e.arguments[0])?e.expression.getText()===_pre_define.RESOURCE_RAWFILE?(isResourcefile(e,t),createResourceParam(0,_pre_define.RESOURCE_TYPE.rawfile,[e.arguments[0]])):getResourceDataNode(e,t):e}function getResourceDataNode(e,t){var r=e.arguments[0].text.trim().split(".");return preCheckResourceData(r,_main.resources,e.arguments[0].getStart(),t)?void 0===(t=_pre_define.RESOURCE_TYPE[r[1]])?(transformLog.errors.push({type:_utils.LogType.ERROR,message:`The resource type ${r[1]} is not supported.`,pos:e.getStart()}),e):createResourceParam(_main.resources[r[0]][r[1]][r[2]],t,_main.projectConfig.compileHar?Array.from(e.arguments):Array.from(e.arguments).slice(1)):e}function isResourcefile(e,t){!process.env.rawFileResource||_utils.storedFileInfo.resourcesArr.has(e.arguments[0].text)||t.isAcceleratePreview||"moduleJson"!==process.env.compileMode||transformLog.errors.push({type:_utils.LogType.WARN,message:`No such '${e.arguments[0].text}' resource in current module.`,pos:e.getStart()})}function createResourceParam(e,t,r){_main.projectConfig.compileHar&&(_main.projectConfig.bundleName="",_main.projectConfig.moduleName="",e=-1);e=[_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createStringLiteral(_pre_define.RESOURCE_NAME_ID),_typescript.default.factory.createNumericLiteral(e)),_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createStringLiteral(_pre_define.RESOURCE_NAME_TYPE),_typescript.default.factory.createNumericLiteral(t)),_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.RESOURCE_NAME_PARAMS),_typescript.default.factory.createArrayLiteralExpression(r,!1))],!_main.projectConfig.bundleName&&""!==_main.projectConfig.bundleName||e.push(_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createStringLiteral(_pre_define.RESOURCE_NAME_BUNDLE),_typescript.default.factory.createStringLiteral(_main.projectConfig.bundleName))),!_main.projectConfig.moduleName&&""!==_main.projectConfig.moduleName||e.push(_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createStringLiteral(_pre_define.RESOURCE_NAME_MODULE),_typescript.default.factory.createStringLiteral(_main.projectConfig.moduleName))),t=_typescript.default.factory.createObjectLiteralExpression(e,!1);return t}function preCheckResourceData(e,t,r,a){return a.isAcceleratePreview?validateResourceData(e,t,r,a.log,!0):validateResourceData(e,t,r,transformLog.errors,!1)}function validateResourceData(e,t,r,a,o){if(3!==e.length)a.push({type:_utils.LogType.ERROR,message:"The input parameter is not supported.",pos:r});else if(o||"rollup"!==process.env.compileTool||"moduleJson"!==process.env.compileMode||_utils.storedFileInfo.collectResourceInFile(e[1]+"_"+e[2],_path.default.resolve(resourceFileName)),t[e[0]])if(t[e[0]][e[1]]){if(t[e[0]][e[1]][e[2]])return!0;a.push({type:_utils.LogType.ERROR,message:`Unknown resource name '${e[2]}'.`,pos:r})}else a.push({type:_utils.LogType.ERROR,message:`Unknown resource type '${e[1]}'.`,pos:r});else a.push({type:_utils.LogType.ERROR,message:`Unknown resource source '${e[0]}'.`,pos:r});return!1}function isWorker(e){return _typescript.default.isNewExpression(e)&&_typescript.default.isPropertyAccessExpression(e.expression)&&_typescript.default.isIdentifier(e.expression.name)&&e.expression.name.escapedText.toString()===_pre_define.WORKER_OBJECT}function processWorker(e){var t,r;return e.arguments.length&&_typescript.default.isStringLiteral(e.arguments[0])?(t=Array.from(e.arguments),r=e.arguments[0].text,r=_typescript.default.factory.createStringLiteral(r.replace(/\.ts$/,".js")),t.splice(0,1,r),_typescript.default.factory.updateNewExpression(e,e.expression,e.typeArguments,t)):e}function processAnimateTo(e){return _typescript.default.factory.updateCallExpression(e,_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.GLOBAL_CONTEXT),_typescript.default.factory.createIdentifier(_pre_define.ATTRIBUTE_ANIMATETO)),e.typeArguments,e.arguments)}function processExtend(r,a,e){const o=isExtendFunction(r,{decoratorName:"",componentName:""},!0);if(o&&r.body&&r.body.statements.length){var i=[];let t;if(e===_pre_define.COMPONENT_EXTEND_DECORATOR){var n=r.body.statements[0].expression;isOriginalExtend(r.body)?(n=_typescript.default.factory.createExpressionStatement(processExtendBody(n)),(0,_process_component_build.bindComponentAttr)(n,_typescript.default.factory.createIdentifier(o),i,a)):t=_typescript.default.visitEachChild(r.body,function e(t){if(_typescript.default.isExpressionStatement(t)&&isDollarNode(t,o)){const r=_typescript.default.factory.createExpressionStatement(processExtendBody(t.expression,o)),a=[];return(0,_process_component_build.bindComponentAttr)(r,_typescript.default.factory.createIdentifier(o),a,[]),_typescript.default.factory.createBlock(a,!0)}return _typescript.default.visitEachChild(t,e,contextGlobal)},contextGlobal);let e;return r.name.getText().startsWith("__"+o+"__")?e=r.name.getText():(e="__"+o+"__"+r.name.getText(),collectExtend(_component_map.EXTEND_ATTRIBUTE,o,r.name.escapedText.toString())),_typescript.default.factory.updateFunctionDeclaration(r,void 0,r.modifiers,r.asteriskToken,_typescript.default.factory.createIdentifier(e),r.typeParameters,r.parameters,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.VoidKeyword),isOriginalExtend(r.body)?_typescript.default.factory.updateBlock(r.body,i):t)}if(e===_pre_define.COMPONENT_ANIMATABLE_EXTEND_DECORATOR)return(0,_process_component_build.bindComponentAttr)(r.body.statements[0],_typescript.default.factory.createIdentifier(o),i,a),_typescript.default.factory.updateFunctionDeclaration(r,void 0,r.modifiers,r.asteriskToken,r.name,r.typeParameters,[...r.parameters,...createAnimatableParameterNode()],_typescript.default.factory.createToken(_typescript.default.SyntaxKind.VoidKeyword),_typescript.default.factory.updateBlock(r.body,createAnimatableBody(o,r.name,r.parameters,i)))}}function createAnimatableParameterNode(){return[_typescript.default.factory.createParameterDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.ELMTID)),_typescript.default.factory.createParameterDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER)),_typescript.default.factory.createParameterDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_PARENT))]}function createAnimatableBody(e,t,r,a){var o=this;const i=[];return r.forEach(function(e){_newArrowCheck(this,o),e.name&&_typescript.default.isIdentifier(e.name)&&i.push(e.name)}.bind(this)),[_typescript.default.factory.createIfStatement(_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER),_typescript.default.factory.createBlock([createAnimatableProperty(e,t,r,i,a),...a],!0),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(e),_typescript.default.factory.createIdentifier(_pre_define.UPDATE_ANIMATABLE_PROPERTY)),void 0,[_typescript.default.factory.createStringLiteral(t.escapedText.toString()),...i]))]))]}function createAnimatableProperty(e,t,r,a,o){var i=_typescript.default.factory.createIdentifier(e);return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(i,_typescript.default.factory.createIdentifier(_pre_define.CREATE_ANIMATABLE_PROPERTY)),void 0,[_typescript.default.factory.createStringLiteral(t.escapedText.toString()),...a,_typescript.default.factory.createArrowFunction(void 0,void 0,r,void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([(0,_process_component_build.createViewStackProcessorStatement)(_pre_define.STARTGETACCESSRECORDINGFOR,_pre_define.ELMTID),createAnimatableFrameNode(e),...o,(0,_process_component_build.createViewStackProcessorStatement)(_pre_define.STOPGETACCESSRECORDING),createAnimatableUpdateFunc()],!0))]))}function createAnimatableFrameNode(e){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.VIEW_STACK_PROCESSOR),_typescript.default.factory.createIdentifier(_pre_define.GET_AND_PUSH_FRAME_NODE)),void 0,[_typescript.default.factory.createStringLiteral(e),_typescript.default.factory.createIdentifier(_pre_define.ELMTID)]))}function createAnimatableUpdateFunc(){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_PARENT),_typescript.default.factory.createIdentifier(_pre_define.FINISH_UPDATE_FUNC)),void 0,[_typescript.default.factory.createIdentifier(_pre_define.ELMTID)]))}function processConcurrent(e){var t;return e.body?(t=[_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createStringLiteral("use concurrent")),...e.body.statements],_typescript.default.factory.updateFunctionDeclaration(e,void 0,e.modifiers,e.asteriskToken,e.name,e.typeParameters,e.parameters,e.type,_typescript.default.factory.updateBlock(e.body,t))):e}function isOriginalExtend(e){let t=e.statements[0];if(1===e.statements.length&&_typescript.default.isExpressionStatement(t)){for(;t.expression;)t=t.expression;if(_typescript.default.isIdentifier(t)&&t.pos&&t.end&&t.pos===t.end&&t.escapedText.toString().match(/Instance$/))return!0}return!1}function isDollarNode(e,t){let r=e;for(;r.expression;)r=r.expression;let a="$";return"rollup"===process.env.compileTool&&_utils.storedFileInfo.reUseProgram&&(a=t+"Instance"),!(!_typescript.default.isIdentifier(r)||r.getText()!==a)}function processExtendBody(e,t){switch(e.kind){case _typescript.default.SyntaxKind.CallExpression:return _typescript.default.factory.createCallExpression(processExtendBody(e.expression,t),void 0,e.arguments);case _typescript.default.SyntaxKind.PropertyAccessExpression:return _typescript.default.factory.createPropertyAccessExpression(processExtendBody(e.expression,t),e.name);case _typescript.default.SyntaxKind.Identifier:return t?_typescript.default.factory.createIdentifier(t):_typescript.default.factory.createIdentifier(e.escapedText.toString().replace(_pre_define.INSTANCE,""))}}function collectExtend(e,t,r){e.has(t)?e.get(t).add(r):e.set(t,new Set([r]))}function isExtendFunction(r,a,o=!1){if(r.decorators&&r.decorators.length)for(let e=0,t=r.decorators.length;e<t;e++)if(_typescript.default.isCallExpression(r.decorators[e].expression)&&(parseExtendNode(r.decorators[e].expression,a,o),_pre_define.CHECK_EXTEND_DECORATORS.includes(a.decoratorName))&&a.componentName)return a.componentName;return null}function parseExtendNode(e,t,r){_typescript.default.isIdentifier(e.expression)&&(t.decoratorName=e.expression.escapedText.toString(),r)&&_pre_define.CHECK_EXTEND_DECORATORS.includes(t.decoratorName)&&e.arguments&&1!==e.arguments.length&&transformLog.errors.push({type:_utils.LogType.ERROR,message:`@${t.decoratorName} should have one and only one parameter`,pos:e.getStart()}),e.arguments.length&&_typescript.default.isIdentifier(e.arguments[0])&&(t.componentName=e.arguments[0].escapedText.toString())}function createEntryNode(e,t,r,a){let o;var i;return _main.projectConfig&&_main.projectConfig.cardObj&&(o=_main.projectConfig.cardObj[resourceFileName]),0!==_validate_ui_syntax.componentCollection.previewComponent.length&&_main.projectConfig.isPreview?(i=createPreviewComponentFunction(_validate_ui_syntax.componentCollection.entryComponent,t,o,r,a),t.factory.updateSourceFile(e,[...e.statements,i])):_validate_ui_syntax.componentCollection.entryComponent?_main.partialUpdateConfig.partialUpdateMode?(i=createEntryFunction(_validate_ui_syntax.componentCollection.entryComponent,t,o,r,a))?t.factory.updateSourceFile(e,[...e.statements,...i]):t.factory.updateSourceFile(e,[...e.statements]):(i=createEntryFunction(_validate_ui_syntax.componentCollection.entryComponent,t,o,r,a),t.factory.updateSourceFile(e,[...e.statements,i])):e}function createEntryFunction(e,t,r,a,o){var o=[t.factory.createStringLiteral(o.toString()),t.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_UNDEFINED),t.factory.createObjectLiteralExpression([],!1)],[i,n]=addStorageParam(e),o=(i&&a&&o.push(a),[t.factory.createNewExpression(t.factory.createIdentifier(e),void 0,o)]);return addCardStringliteral(o,t,r),_main.partialUpdateConfig.partialUpdateMode?r?(n&&_typescript.default.isObjectLiteralExpression(n)&&transformLog.errors.push({type:_utils.LogType.ERROR,message:"@Entry doesn't support {} parameter in card",pos:_validate_ui_syntax.componentCollection.entryComponentPos}),[createStartGetAccessRecording(t),createLoadDocument(t,e,r,i,a),createStopGetAccessRecording(t)]):createLoadPageConditionalJudgMent(t,e,r,i,n):t.factory.createExpressionStatement(t.factory.createCallExpression(t.factory.createIdentifier(r?_pre_define.CARD_ENTRY_FUNCTION_NAME:_pre_define.PAGE_ENTRY_FUNCTION_NAME),void 0,o))}function createLoadPageConditionalJudgMent(e,t,r,a,o,i=void 0,n=!1){var c=this;let s=!1,p,l;return o?(_typescript.default.isObjectLiteralExpression(o)?(s=!0,o.properties&&o.properties.forEach(function(e){_newArrowCheck(this,c),_typescript.default.isPropertyAssignment(e)&&e.name&&_typescript.default.isIdentifier(e.name)&&(e.name.escapedText.toString()===_pre_define.ROUTE_NAME?p=e.initializer:e.name.escapedText.toString()===_pre_define.STORAGE&&(l=e.initializer))}.bind(this))):s=!1,s?p&&!l?n?[...assignRouteNameAndStorage(p,l,!0,!1),...createLoadDocumentWithRoute(e,t,r,s,o,p,l,!0,!1,!1,i)]:[_typescript.default.factory.createBlock([...assignRouteNameAndStorage(p,l,!0,!1),...createLoadDocumentWithRoute(e,t,r,s,o,p,l,!0,!1,!1,i)])]:p||l?!p&&l?n?[...assignRouteNameAndStorage(p,l,!1,!0),...createLoadDocumentWithRoute(e,t,r,s,o,p,l,!1,!0,!0,i)]:[_typescript.default.factory.createBlock([...assignRouteNameAndStorage(p,l,!1,!0),...createLoadDocumentWithRoute(e,t,r,s,o,p,l,!1,!0,!0,i)])]:n?[...assignRouteNameAndStorage(p,l,!0,!0),judgeRouteNameAndStorage(e,t,r,s,o,p,l,i)]:[_typescript.default.factory.createBlock([...assignRouteNameAndStorage(p,l,!0,!0),judgeRouteNameAndStorage(e,t,r,s,o,p,l,i)])]:n?[...assignRouteNameAndStorage(p,l,!1,!1),...createLoadDocumentWithRoute(e,t,r,s,o,p,l,!1,!1,!0,i)]:[_typescript.default.factory.createBlock([...assignRouteNameAndStorage(p,l,!1,!1),...createLoadDocumentWithRoute(e,t,r,s,o,p,l,!1,!1,!0,i)])]:[judgeRouteNameAndStorage(e,t,r,s,o,p,l,i)]):[createStartGetAccessRecording(e),createLoadDocument(e,t,r,a,o),createStopGetAccessRecording(e)]}function judgeRouteNameAndStorage(e,t,r,a,o,i,n,c=void 0){return _typescript.default.factory.createIfStatement(a?judgeRouteAndStorageForObject(!0,!0):judgeRouteAndStorageForIdentifier(o,!0,!0),_typescript.default.factory.createBlock([...createLoadDocumentWithRoute(e,t,r,a,o,i,n,!0,!0,!1,c)],!0),_typescript.default.factory.createIfStatement(a?judgeRouteAndStorageForObject(!0,!1):judgeRouteAndStorageForIdentifier(o,!0,!1),_typescript.default.factory.createBlock([...createLoadDocumentWithRoute(e,t,r,a,o,i,n,!0,!1,!1,c)],!0),_typescript.default.factory.createIfStatement(a?judgeRouteAndStorageForObject(!1,!0):judgeRouteAndStorageForIdentifier(o,!1,!0),_typescript.default.factory.createBlock([...createLoadDocumentWithRoute(e,t,r,a,o,i,n,!1,!0,!0,c)],!0),_typescript.default.factory.createBlock([...createLoadDocumentWithRoute(e,t,r,a,o,i,n,!1,!1,!0,c)],!0))))}function judgeRouteAndStorageForObject(e,t){return _typescript.default.factory.createBinaryExpression(_typescript.default.factory.createBinaryExpression(_typescript.default.factory.createIdentifier(_pre_define.ROUTENAME_NODE),_typescript.default.factory.createToken(e?_typescript.default.SyntaxKind.ExclamationEqualsToken:_typescript.default.SyntaxKind.EqualsEqualsToken),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_UNDEFINED)),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.AmpersandAmpersandToken),_typescript.default.factory.createBinaryExpression(_typescript.default.factory.createIdentifier(_pre_define.STORAGE_NODE),_typescript.default.factory.createToken(t?_typescript.default.SyntaxKind.ExclamationEqualsToken:_typescript.default.SyntaxKind.EqualsEqualsToken),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_UNDEFINED)))}function judgeRouteAndStorageForIdentifier(e,t,r){return _typescript.default.factory.createBinaryExpression(_typescript.default.factory.createBinaryExpression(e,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.AmpersandAmpersandToken),_typescript.default.factory.createBinaryExpression(_typescript.default.factory.createPropertyAccessExpression(e,_typescript.default.factory.createIdentifier(_pre_define.ROUTE_NAME)),_typescript.default.factory.createToken(t?_typescript.default.SyntaxKind.ExclamationEqualsToken:_typescript.default.SyntaxKind.EqualsEqualsToken),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_UNDEFINED))),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.AmpersandAmpersandToken),_typescript.default.factory.createBinaryExpression(_typescript.default.factory.createPropertyAccessExpression(e,_typescript.default.factory.createIdentifier(_pre_define.STORAGE)),_typescript.default.factory.createToken(r?_typescript.default.SyntaxKind.ExclamationEqualsToken:_typescript.default.SyntaxKind.EqualsEqualsToken),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_UNDEFINED)))}function assignRouteNameAndStorage(e,t,r,a){var o=[];return r&&o.push(_typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define.ROUTENAME_NODE),void 0,void 0,e)],_typescript.default.NodeFlags.Let))),a&&o.push(_typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define.STORAGE_NODE),void 0,void 0,t)],_typescript.default.NodeFlags.Let))),o}function createLoadDocumentWithRoute(r,a,e,t,o,i,n,c,s,p,l){var d=this;const f=[r.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_UNDEFINED),r.factory.createObjectLiteralExpression([],!1)];o&&(t?n&&s&&f.push(_typescript.default.factory.createIdentifier(_pre_define.STORAGE_NODE)):s?f.push(_typescript.default.factory.createPropertyAccessExpression(o,_typescript.default.factory.createIdentifier(_pre_define.STORAGE))):c||f.push(o));n=[r.factory.createNewExpression(r.factory.createIdentifier(a),void 0,f)];return l&&(l=[],_validate_ui_syntax.componentCollection.previewComponent.forEach(function(e){_newArrowCheck(this,d);var t=r.factory.createNewExpression(r.factory.createIdentifier(e),void 0,e===a?f:f.slice(0,f.length-1));l.push(r.factory.createStringLiteral(e),t)}.bind(this))),c?[p?createStartGetAccessRecording(r):void 0,r.factory.createExpressionStatement(r.factory.createCallExpression(r.factory.createIdentifier(_pre_define.REGISTER_NAMED_ROUTE),void 0,[r.factory.createArrowFunction(void 0,void 0,[],void 0,r.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),n[0]),t?_typescript.default.factory.createIdentifier(_pre_define.ROUTENAME_NODE):r.factory.createPropertyAccessExpression(o,r.factory.createIdentifier(_pre_define.ROUTE_NAME)),r.factory.createObjectLiteralExpression([r.factory.createPropertyAssignment(r.factory.createIdentifier(_pre_define.RESOURCE_NAME_BUNDLE),r.factory.createStringLiteral(_main.projectConfig.bundleName||"")),r.factory.createPropertyAssignment(r.factory.createIdentifier(_pre_define.RESOURCE_NAME_MODULE),r.factory.createStringLiteral(_main.projectConfig.moduleName||"")),r.factory.createPropertyAssignment(r.factory.createIdentifier(_pre_define.PAGE_PATH),r.factory.createStringLiteral(_main.projectConfig.compileHar?"":_path.default.relative(_main.projectConfig.projectPath||"",resourceFileName).replace(/\\/g,"/").replace(/\.ets$/,"")))],!1)])),p?createStopGetAccessRecording(r):void 0]:[p?createStartGetAccessRecording(r):void 0,r.factory.createExpressionStatement(r.factory.createCallExpression(r.factory.createIdentifier(e?_pre_define.CARD_ENTRY_FUNCTION_NAME:_pre_define.PAGE_ENTRY_FUNCTION_NAME),void 0,n)),p?createStopGetAccessRecording(r):void 0]}function createStartGetAccessRecording(e){return e.factory.createExpressionStatement(e.factory.createCallExpression(e.factory.createPropertyAccessExpression(e.factory.createIdentifier(_pre_define.VIEWSTACKPROCESSOR),e.factory.createIdentifier(_pre_define.STARTGETACCESSRECORDINGFOR)),void 0,[e.factory.createCallExpression(e.factory.createPropertyAccessExpression(e.factory.createIdentifier(_pre_define.VIEWSTACKPROCESSOR),e.factory.createIdentifier(_pre_define.ALLOCATENEWELMETIDFORNEXTCOMPONENT)),void 0,[])]))}function createLoadDocument(e,t,r,a,o){var i=[e.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_UNDEFINED),e.factory.createObjectLiteralExpression([],!1)],a=(a&&o&&i.push(o),[e.factory.createNewExpression(e.factory.createIdentifier(t),void 0,i)]);return addCardStringliteral(a,e,r),e.factory.createExpressionStatement(e.factory.createCallExpression(e.factory.createIdentifier(r?_pre_define.CARD_ENTRY_FUNCTION_NAME:_pre_define.PAGE_ENTRY_FUNCTION_NAME),void 0,a))}function createStopGetAccessRecording(e){return e.factory.createExpressionStatement(e.factory.createCallExpression(e.factory.createPropertyAccessExpression(e.factory.createIdentifier(_pre_define.VIEWSTACKPROCESSOR),e.factory.createIdentifier(_pre_define.STOPGETACCESSRECORDING)),void 0,[]))}function addStorageParam(e){let t,r;var a=(_validate_ui_syntax.localStorageLinkCollection.get(e)||new Set).size+(_validate_ui_syntax.localStoragePropCollection.get(e)||new Set).size;return _validate_ui_syntax.componentCollection.entryComponent===e&&_validate_ui_syntax.componentCollection.localStorageNode&&(r=_validate_ui_syntax.componentCollection.localStorageNode),_validate_ui_syntax.componentCollection.entryComponent===e&&_validate_ui_syntax.componentCollection.localStorageName?t=_validate_ui_syntax.componentCollection.localStorageName:_validate_ui_syntax.componentCollection.entryComponent!==e||_validate_ui_syntax.componentCollection.localStorageName||_validate_ui_syntax.componentCollection.localStorageNode||!a||transformLog.errors.push({type:_utils.LogType.WARN,message:"@Entry should have a parameter, like '@Entry (storage)'.",pos:_validate_ui_syntax.componentCollection.entryComponentPos}),[t,r]}function createPreviewComponentFunction(e,r,t,a,o){var i=this;const n=_main.partialUpdateConfig.partialUpdateMode?[r.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_UNDEFINED),r.factory.createObjectLiteralExpression([],!1)]:[r.factory.createStringLiteral(o.toString()),r.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_UNDEFINED),r.factory.createObjectLiteralExpression([],!1)];var[o,c]=addStorageParam(e);c&&n.push(c);const s=[];_validate_ui_syntax.componentCollection.previewComponent.forEach(function(e){_newArrowCheck(this,i);var t=r.factory.createNewExpression(r.factory.createIdentifier(e),void 0,n);s.push(r.factory.createStringLiteral(e)),s.push(t)}.bind(this));var p=e?[r.factory.createNewExpression(r.factory.createIdentifier(e),void 0,n)]:[],e=(addCardStringliteral(p,r,t),r.factory.createIfStatement(r.factory.createCallExpression(r.factory.createIdentifier(_pre_define.GET_PREVIEW_FLAG_FUNCTION_NAME),void 0,[]),r.factory.createBlock([...storePreviewComponents(e,c,s),r.factory.createExpressionStatement(r.factory.createCallExpression(r.factory.createIdentifier(_pre_define.PREVIEW_COMPONENT_FUNCTION_NAME),void 0,[]))],!0),r.factory.createBlock(createPreviewElseBlock(e,r,t,o,c,p,s),!0)));return e}function storePreviewComponents(e,t,r){var a=this;let o=!1,i;if(!t)return[_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.STORE_PREVIEW_COMPONENTS),void 0,[_typescript.default.factory.createNumericLiteral(_validate_ui_syntax.componentCollection.previewComponent.length),...r]))];_typescript.default.isObjectLiteralExpression(t)?(o=!0,t.properties&&t.properties.forEach(function(e){_newArrowCheck(this,a),_typescript.default.isPropertyAssignment(e)&&e.name&&_typescript.default.isIdentifier(e.name)&&e.name.escapedText.toString()===_pre_define.STORAGE&&(i=e.initializer)}.bind(this))):o=!1;r=[_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_UNDEFINED),_typescript.default.factory.createObjectLiteralExpression([],!1)];return o?processObjectStorage(i,r,e,[]):[_typescript.default.factory.createIfStatement(_typescript.default.factory.createBinaryExpression(t,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.AmpersandAmpersandToken),_typescript.default.factory.createBinaryExpression(_typescript.default.factory.createPropertyAccessExpression(t,_typescript.default.factory.createIdentifier(_pre_define.STORAGE)),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.ExclamationEqualsToken),_typescript.default.factory.createIdentifier("undefined"))),_typescript.default.factory.createBlock([returnStorePreview(t,!0,e)],!0),_typescript.default.factory.createBlock([returnStorePreview(t,!1,e)],!0))]}function processObjectStorage(e,r,a,o){var i=this;return e?(r.push(_typescript.default.factory.createIdentifier(_pre_define.STORAGE_NODE)),_validate_ui_syntax.componentCollection.previewComponent.forEach(function(e){_newArrowCheck(this,i);var t=_typescript.default.factory.createNewExpression(_typescript.default.factory.createIdentifier(e),void 0,e===a?r:r.slice(0,r.length-1));o.push(_typescript.default.factory.createStringLiteral(e)),o.push(t)}.bind(this)),[_typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define.STORAGE_NODE),void 0,void 0,e)],_typescript.default.NodeFlags.Let)),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.STORE_PREVIEW_COMPONENTS),void 0,[_typescript.default.factory.createNumericLiteral(_validate_ui_syntax.componentCollection.previewComponent.length),...o]))]):(_validate_ui_syntax.componentCollection.previewComponent.forEach(function(e){_newArrowCheck(this,i);var t=_typescript.default.factory.createNewExpression(_typescript.default.factory.createIdentifier(e),void 0,r);o.push(_typescript.default.factory.createStringLiteral(e)),o.push(t)}.bind(this)),[_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.STORE_PREVIEW_COMPONENTS),void 0,[_typescript.default.factory.createNumericLiteral(_validate_ui_syntax.componentCollection.previewComponent.length),...o]))])}function returnStorePreview(e,t,r){var a=this;const o=[_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_UNDEFINED),_typescript.default.factory.createObjectLiteralExpression([],!1)],i=[];return o.push(t?_typescript.default.factory.createPropertyAccessExpression(e,_typescript.default.factory.createIdentifier(_pre_define.STORAGE)):e),_validate_ui_syntax.componentCollection.previewComponent.forEach(function(e){_newArrowCheck(this,a);var t=_typescript.default.factory.createNewExpression(_typescript.default.factory.createIdentifier(e),void 0,e===r?o:o.slice(0,o.length-1));i.push(_typescript.default.factory.createStringLiteral(e)),i.push(t)}.bind(this)),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.STORE_PREVIEW_COMPONENTS),void 0,[_typescript.default.factory.createNumericLiteral(_validate_ui_syntax.componentCollection.previewComponent.length),...i]))}function createPreviewElseBlock(e,t,r,a,o,i,n){if(e)return _main.partialUpdateConfig.partialUpdateMode?r?(o&&_typescript.default.isObjectLiteralExpression(o)&&transformLog.errors.push({type:_utils.LogType.ERROR,message:"@Entry doesn't support {} parameter in card",pos:_validate_ui_syntax.componentCollection.entryComponentPos}),[e?createStartGetAccessRecording(t):void 0,e?t.factory.createExpressionStatement(t.factory.createCallExpression(t.factory.createIdentifier(r?_pre_define.CARD_ENTRY_FUNCTION_NAME:_pre_define.PAGE_ENTRY_FUNCTION_NAME),void 0,i)):void 0,e?createStopGetAccessRecording(t):void 0]):createLoadPageConditionalJudgMent(t,e,r,a,o,n,!0):[t.factory.createExpressionStatement(t.factory.createCallExpression(t.factory.createIdentifier(_pre_define.STORE_PREVIEW_COMPONENTS),void 0,[t.factory.createNumericLiteral(_validate_ui_syntax.componentCollection.previewComponent.length),...n])),t.factory.createExpressionStatement(t.factory.createCallExpression(t.factory.createIdentifier(r?_pre_define.CARD_ENTRY_FUNCTION_NAME:_pre_define.PAGE_ENTRY_FUNCTION_NAME),void 0,i))]}function resetLog(){transformLog.errors=[]}function addCardStringliteral(e,t,r){r&&e.push(t.factory.createStringLiteral(_main.projectConfig.bundleName+"/"+_main.projectConfig.moduleName+"/"+r))}function validatorCard(e,t,r,a=""){if(_main.projectConfig&&_main.projectConfig.cardObj&&resourceFileName&&_main.projectConfig.cardObj[resourceFileName]){var o={type:_utils.LogType.ERROR,message:"",pos:r};switch(t){case _pre_define.CARD_LOG_TYPE_COMPONENTS:o.message=`Card page cannot use the component ${a}.`;break;case _pre_define.CARD_LOG_TYPE_DECORATORS:o.message="Card page cannot use "+a;break;case _pre_define.CARD_LOG_TYPE_IMPORT:o.message="Card page cannot use import."}e.push(o)}}exports.compilingEtsOrTsFiles=compilingEtsOrTsFiles;