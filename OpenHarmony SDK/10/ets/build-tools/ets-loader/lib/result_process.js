"use strict";var _pre_define=require("./pre_define"),_process_ui_syntax=require("./process_ui_syntax"),_validate_ui_syntax=require("./validate_ui_syntax"),_utils=require("./utils"),_ark_utils=require("./ark_utils"),_main=require("../main"),_compile_info=require("./compile_info");module.exports=function(e,i){process.env.compiler=_pre_define.BUILD_OFF,e=(0,_validate_ui_syntax.processSystemApi)(e,!0,this.resourcePath),/\.(ets|ts)$/.test(this.resourcePath)&&(_utils.componentInfo.id=0,_validate_ui_syntax.propertyCollection.clear(),_validate_ui_syntax.linkCollection.clear(),(0,_validate_ui_syntax.resetComponentCollection)(),_process_ui_syntax.transformLog)&&_process_ui_syntax.transformLog.errors.length&&((0,_utils.emitLogInfo)(this,(0,_utils.getTransformLog)(_process_ui_syntax.transformLog)),(0,_process_ui_syntax.resetLog)()),_main.projectConfig.compileMode==_pre_define.JSBUNDLE&&[_main.abilityConfig.abilityEntryFile].concat(_main.abilityConfig.projectAbilityPath).concat(_main.abilityConfig.testRunnerFile).includes(this.resourcePath)&&(e=e.replace(/exports\.default/,"globalThis.exports.default")),_main.projectConfig.compileMode==_pre_define.ESMODULE&&!1===_main.projectConfig.processTs&&process.env.compilerType&&"ark"===process.env.compilerType&&!_main.projectConfig.compileHar&&(0,_ark_utils.generateSourceFilesToTemporary)(this.resourcePath,e,i,_main.projectConfig,_compile_info.logger),_main.projectConfig.compileHar&&(0,_utils.generateSourceFilesInHar)(this.resourcePath,e,".js",_main.projectConfig),this.callback(null,e,i)};