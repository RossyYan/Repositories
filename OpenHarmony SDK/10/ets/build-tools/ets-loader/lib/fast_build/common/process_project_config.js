"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getEntryObj=getEntryObj,exports.setCopyPluginConfig=setCopyPluginConfig,exports.workerFile=void 0;var _fs=_interopRequireDefault(require("fs")),_path=_interopRequireDefault(require("path"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _newArrowCheck(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}const{projectConfig,loadEntryObj,abilityConfig,initBuildInfo,readWorkerFile,loadWorker,readPatchConfig,loadModuleInfo}=require("../../../main.js");let workerFile=null;function getEntryObj(){var r=this;loadEntryObj(projectConfig),initBuildInfo(),readPatchConfig(),loadModuleInfo(projectConfig),exports.workerFile=workerFile=readWorkerFile(),projectConfig.isPreview||loadWorker(projectConfig,workerFile),projectConfig.entryObj=Object.keys(projectConfig.entryObj).reduce(function(e,t){return _newArrowCheck(this,r),e[t.replace(/^\.\//,"")]=projectConfig.entryObj[t].replace("?entry",""),e}.bind(this),{})}function setCopyPluginConfig(e,t){var r=[],o="../share",i=(r.push({src:[_path.default.resolve(e.projectPath,"**/*"),"!**/*.ets","!**/*.ts","!**/*.js","!"+e.buildPath],dest:e.buildPath}),_path.default.resolve(e.projectPath,o));return _fs.default.existsSync(i)&&r.push({src:[_path.default.resolve(e.projectPath,o,"**/*"),"!**/*.ets","!**/*.ts","!**/*.js"],dest:_path.default.resolve(e.buildPath,o)}),"page"===abilityConfig.abilityType&&(_fs.default.existsSync(e.manifestFilePath)?r.push({src:e.manifestFilePath,dest:e.buildPath}):_fs.default.existsSync(e.aceConfigPath)&&r.push({src:e.aceConfigPath,dest:e.buildPath})),t&&_fs.default.existsSync(t)&&!e.xtsMode&&e.isPreview&&r.push({src:_path.default.resolve(__dirname,t),dest:_path.default.resolve(__dirname,e.cachePath)}),r}exports.workerFile=workerFile;