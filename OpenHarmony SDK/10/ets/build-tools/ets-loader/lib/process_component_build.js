"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindComponentAttr=bindComponentAttr,exports.createComponentCreationStatement=createComponentCreationStatement,exports.createFunction=createFunction,exports.createViewStackProcessorStatement=createViewStackProcessorStatement,exports.getName=getName,exports.ifRetakeId=ifRetakeId,exports.isAttributeNode=isAttributeNode,exports.parentConditionalExpression=parentConditionalExpression,exports.processComponentBlock=processComponentBlock,exports.processComponentBuild=processComponentBuild,exports.processComponentChild=processComponentChild,exports.processObjectPropertyBuilder=processObjectPropertyBuilder,exports.transferBuilderCall=transferBuilderCall,exports.validateStateStyleSyntax=validateStateStyleSyntax;var _typescript=_interopRequireDefault(require("typescript")),_path=_interopRequireDefault(require("path")),_pre_define=require("./pre_define"),_component_map=require("./component_map"),_validate_ui_syntax=require("./validate_ui_syntax"),_process_custom_component=require("./process_custom_component"),_utils=require("./utils"),_main=require("../main"),_process_ui_syntax=require("./process_ui_syntax"),_compile_info=require("./compile_info");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _newArrowCheck(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}const checkComponents=new Set(["TextArea","TextInput","GridContainer"]);function processComponentBuild(e,t){let r,i;return i=_main.partialUpdateConfig.partialUpdateMode?_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_INITIAl_RENDER_FUNCTION):_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_RENDER_FUNCTION),r=e.body&&e.body.statements&&e.body.statements.length&&validateRootNode(e,t)?_typescript.default.factory.updateMethodDeclaration(e,e.decorators,e.modifiers,e.asteriskToken,i,e.questionToken,e.typeParameters,e.parameters,e.type,processComponentBlock(e.body,!1,t)):_typescript.default.factory.updateMethodDeclaration(e,e.decorators,e.modifiers,e.asteriskToken,i,e.questionToken,e.typeParameters,e.parameters,e.type,e.body)}function processComponentBlock(e,t,r,i=!1,a=!1,n=void 0,s=void 0,p=!1){var o=[];return processComponentChild(e,o,r,{isAcceleratePreview:!1,line:0,column:0,fileName:""},a,n,s,p,i),t&&!_main.partialUpdateConfig.partialUpdateMode&&o.unshift(createRenderingInProgress(!0)),i&&(_main.partialUpdateConfig.partialUpdateMode?o.unshift(createComponentCreationStatement(_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_TRANSITION_NAME),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null)),[_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_TRANSITION_NAME),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),null))],_pre_define.COMPONENT_TRANSITION_NAME,!1,i)):o.unshift(_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_TRANSITION_NAME),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),null))),o.push(_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_TRANSITION_NAME),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null)))),t&&!_main.partialUpdateConfig.partialUpdateMode&&o.push(createRenderingInProgress(!1)),_typescript.default.factory.updateBlock(e,o)}function validateRootNode(e,t){let r=!1;var i;return 1===e.body.statements.length?(i=e.body.statements[0],(_typescript.default.isIfStatement(i)||validateFirstNode(i))&&(r=!0)):r=!1,r||t.push({type:_utils.LogType.ERROR,message:"There should have a root container component.",pos:e.body.statements.pos}),r}function validateFirstNode(e){return!(_validate_ui_syntax.componentCollection.entryComponent===_validate_ui_syntax.componentCollection.currentClassName&&!validateContainerComponent(e))}function validateContainerComponent(e){if(_typescript.default.isExpressionStatement(e)&&e.expression&&(_typescript.default.isEtsComponentExpression(e.expression)||_typescript.default.isCallExpression(e.expression))){var t={name:null,node:null,arguments:[]};if(validateEtsComponentNode(e.expression,t),t.name&&checkContainer(t.name,t.node))return!0}return!1}let newsupplement={isAcceleratePreview:!1,line:0,column:0,fileName:""};function validateEtsComponentNode(e,t){let r=e;for(t.name=null;_typescript.default.isCallExpression(r)&&r.expression&&_typescript.default.isPropertyAccessExpression(r.expression)&&r.expression.expression;)r=r.expression.expression;return!!_typescript.default.isEtsComponentExpression(r)&&(_typescript.default.isIdentifier(r.expression)&&(t.name=r.expression.getText(),t.node=r,t.arguments=r.arguments||[]),!0)}let sourceNode;function processComponentChild(e,a,n,t={isAcceleratePreview:!1,line:0,column:0,fileName:""},s=!1,p=void 0,o=void 0,c=!1,d=!1){var r,f=this;if(t.isAcceleratePreview&&(newsupplement=t,r=_typescript.default.readConfigFile(_path.default.resolve(__dirname,"../tsconfig.json"),_typescript.default.sys.readFile).config.compilerOptions,Object.assign(r,{sourceMap:!1}),sourceNode=_typescript.default.createSourceFile("",e.getText(),_typescript.default.ScriptTarget.Latest,!0,_typescript.default.ScriptKind.ETS,r)),e.statements.length){const _=p;e.statements.forEach(function(e){if(_newArrowCheck(this,f),_typescript.default.isExpressionStatement(e)){checkEtsComponent(e,n);var t=getName(e);switch(_pre_define.CARD_ENABLE_COMPONENTS.has(t)&&(0,_process_ui_syntax.validatorCard)(n,_pre_define.CARD_LOG_TYPE_COMPONENTS,e.getStart(),t),getComponentType(e,n,t,p,o)){case ComponentType.innerComponent:var[r,i]=checkEtsAndIdInIf(e,_);_typescript.default.isIdentifier(r.expression)&&(p=r.expression.escapedText.toString()),processInnerComponent(e,a,n,p,s,c,d,i);break;case ComponentType.customComponent:r=checkIdInIf(e,_);p=void 0,newsupplement.isAcceleratePreview||(e.expression&&_typescript.default.isEtsComponentExpression(e.expression)&&e.expression.body&&(i=processExpressionStatementChange(e,e.expression.body,n))&&(e=i),(0,_process_custom_component.processCustomComponent)(e,a,n,t,s,c,r));break;case ComponentType.forEachComponent:p=void 0,_main.partialUpdateConfig.partialUpdateMode?processForEachComponentNew(e,a,n,c):processForEachComponent(e,a,n,s,c);break;case ComponentType.customBuilderMethod:p=void 0,_main.partialUpdateConfig.partialUpdateMode?a.push(transferBuilderCall(e,t,s)):a.push(addInnerBuilderParameter(e,c));break;case ComponentType.builderParamMethod:case ComponentType.builderTypeFunction:p=void 0,_main.partialUpdateConfig.partialUpdateMode?a.push(transferBuilderCall(e,t,s)):a.push(addInnerBuilderParameter(e));break;case ComponentType.function:p=void 0,a.push(e)}}else _typescript.default.isIfStatement(e)?processIfStatement(e,a,n,s,c):_typescript.default.isBlock(e)||n.push({type:_utils.LogType.ERROR,message:"Only UI component syntax can be written in build method.",pos:e.getStart()})}.bind(this))}t.isAcceleratePreview&&(newsupplement={isAcceleratePreview:!1,line:0,column:0,fileName:""})}function transferBuilderCall(e,t,r=!1){return e.expression&&_typescript.default.isCallExpression(e.expression)&&e.expression.arguments&&1===e.expression.arguments.length&&_typescript.default.isObjectLiteralExpression(e.expression.arguments[0])?_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.expression.expression,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()]),void 0,[_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.BUILDER_PARAM_PROXY),void 0,[_typescript.default.factory.createStringLiteral(t),traverseBuilderParams(e.expression.arguments[0],r)])])):_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.expression.expression,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()]),void 0,e.expression.arguments))}function traverseBuilderParams(e,r){var i=this;const a=[];return e.properties&&e.properties.length&&e.properties.forEach(function(e){var t;_newArrowCheck(this,i),_typescript.default.isPropertyAssignment(e)&&e.initializer&&_typescript.default.isPropertyAccessExpression(e.initializer)&&e.initializer.expression&&e.initializer.name&&_typescript.default.isIdentifier(e.initializer.name)&&(t=e.initializer.name.escapedText.toString(),!r&&e.initializer.expression.kind===_typescript.default.SyntaxKind.ThisKeyword||r&&_typescript.default.isIdentifier(e.initializer.expression)&&e.initializer.expression.escapedText.toString()===_pre_define.$$)?addProperties(a,e,t,r):a.push(_typescript.default.factory.createPropertyAssignment(e.name,_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),e.initializer)))}.bind(this)),_typescript.default.factory.createObjectLiteralExpression(a)}function addProperties(e,t,r,i){e.push(_typescript.default.factory.createPropertyAssignment(t.name,_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createParenthesizedExpression(_typescript.default.factory.createConditionalExpression(_typescript.default.factory.createElementAccessExpression(i?_typescript.default.factory.createIdentifier(_pre_define.$$):_typescript.default.factory.createThis(),_typescript.default.factory.createStringLiteral("__"+r)),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.QuestionToken),_typescript.default.factory.createElementAccessExpression(i?_typescript.default.factory.createIdentifier(_pre_define.$$):_typescript.default.factory.createThis(),_typescript.default.factory.createStringLiteral("__"+r)),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.ColonToken),_typescript.default.factory.createElementAccessExpression(i?_typescript.default.factory.createIdentifier(_pre_define.$$):_typescript.default.factory.createThis(),_typescript.default.factory.createStringLiteral(r)))))))}function addInnerBuilderParameter(e,t=!1){return e.expression&&_typescript.default.isCallExpression(e.expression)&&e.expression.arguments?(e.expression.arguments.push(t?parentConditionalExpression():_typescript.default.factory.createThis()),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.updateCallExpression(e.expression,e.expression.expression,e.expression.typeArguments,e.expression.arguments))):e}function processExpressionStatementChange(e,t,r){let i;return e.expression.expression&&_typescript.default.isIdentifier(e.expression.expression)&&(i=e.expression.expression.escapedText.toString()),_validate_ui_syntax.builderParamObjectCollection.get(i)&&1===_validate_ui_syntax.builderParamObjectCollection.get(i).size?processBlockToExpression(e,t,r,i):(r.push({type:_utils.LogType.ERROR,message:`In the trailing lambda case, '${i}' must have one and only one property decorated with `+"@BuilderParam, and its @BuilderParam expects no parameter.",pos:e.getStart()}),null)}function processBlockToExpression(e,t,r,i){i=[..._validate_ui_syntax.builderParamObjectCollection.get(i)].slice(-1)[0],t=processComponentBlock(t,!1,r),r=_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),t),t=_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(i),r);let a=e.expression.arguments;a=a&&!a.length?[_typescript.default.factory.createObjectLiteralExpression([t],!0)]:[_typescript.default.factory.createObjectLiteralExpression(e.expression.arguments[0].properties.concat([t]),!0)];i=_typescript.default.factory.updateCallExpression(e.expression,e.expression.expression,e.expression.expression.typeArguments,a);return(e.expression.expression.parent=i).parent=e.expression.parent,e=_typescript.default.factory.updateExpressionStatement(e,i)}function parseEtsComponentExpression(e){let t,r=!1,i=e.expression;for(;i;){if(_typescript.default.isCallExpression(i)&&i.expression&&_typescript.default.isPropertyAccessExpression(i.expression)&&(r=!0),_typescript.default.isEtsComponentExpression(i)){t=i;break}i=i.expression}return{etsComponentNode:t,hasAttr:r}}function processInnerComponent(e,t,r,i=void 0,a=!1,n=!1,s=!1,p=void 0){var o=createComponent(e,_pre_define.COMPONENT_CREATE_FUNCTION),o=([].push(o.newNode),{name:null,arguments:[]});validateEtsComponentNode(e.expression,o),_main.partialUpdateConfig.partialUpdateMode&&_pre_define.ItemComponents.includes(o.name)?processItemComponent(e,o,t,r,n,p):_main.partialUpdateConfig.partialUpdateMode&&_pre_define.TabContentAndNavDestination.has(o.name)?processTabAndNav(e,t,o,r,n,p):processNormalComponent(e,o,t,r,i,a,n,s,p)}function processNormalComponent(e,t,r,i,a=void 0,n=!1,s=!1,p=!1,o=void 0){var c=[],d=[],f=createComponent(e,_pre_define.COMPONENT_CREATE_FUNCTION),t=(c.push(f.newNode),processDebug(e,t,c),parseEtsComponentExpression(e)),_=f.identifierNode.getText();let l;_main.partialUpdateConfig.partialUpdateMode&&o&&(l=r.length),t.etsComponentNode.body&&_typescript.default.isBlock(t.etsComponentNode.body)?(f.isButton&&(checkButtonParamHasLabel(t.etsComponentNode,i),_main.projectConfig.isPreview?c.splice(-2,1,createComponent(e,_pre_define.COMPONENT_CREATE_CHILD_FUNCTION).newNode):c.splice(-1,1,createComponent(e,_pre_define.COMPONENT_CREATE_CHILD_FUNCTION).newNode)),t.hasAttr&&bindComponentAttr(e,f.identifierNode,c,i,!0,!1,d),processInnerCompStatements(r,c,e,s,p,void 0,d,_),processComponentChild(t.etsComponentNode.body,r,i,{isAcceleratePreview:!1,line:0,column:0,fileName:""},n,a,void 0,s,!1)):(bindComponentAttr(e,f.identifierNode,c,i,!0,!1,d),processInnerCompStatements(r,c,e,s,p,void 0,d,_)),(f.isContainerComponent||f.needPop)&&r.push(createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode),_main.partialUpdateConfig.partialUpdateMode&&o&&r.splice(l,r.length-l,ifRetakeId(r.slice(l),o))}function ifRetakeId(e,t){return _typescript.default.factory.createIfStatement(_typescript.default.factory.createPrefixUnaryExpression(_typescript.default.SyntaxKind.ExclamationToken,_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_IF),_typescript.default.factory.createIdentifier(_pre_define.CAN_RETAKE)),void 0,[t])),_typescript.default.factory.createBlock(e,!0),void 0)}function processDebug(n,s,p,o=!1){if(_main.projectConfig.isPreview&&s.name&&!_component_map.NO_DEBUG_LINE_COMPONENT.has(s.name)){let e,t,r=1,i=1;sourceNode&&newsupplement.isAcceleratePreview?(e=sourceNode.getLineAndCharacterOfPosition(getRealNodePos(n)-22),t=newsupplement.fileName,0===e.line&&(i=newsupplement.column-1),r=newsupplement.line):(e=_process_ui_syntax.transformLog.sourceFile.getLineAndCharacterOfPosition(getRealNodePos(n)),t=_process_ui_syntax.transformLog.sourceFile.fileName.replace(/\.ts$/,""));let a;a=10<=_main.projectConfig.minAPIVersion?""+_path.default.relative(_main.projectConfig.projectRootPath,t).replace(/\\+/g,"/")+`(${e.line+r}:${e.character+i})`:""+_path.default.relative(_main.projectConfig.projectPath,t).replace(/\\+/g,"/")+`(${e.line+r}:${e.character+i})`;n=_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(s.name),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_DEBUGLINE_FUNCTION),_typescript.default.factory.createNodeArray([_typescript.default.factory.createStringLiteral(a)])));if(o)return n;p.push(n)}}function processInnerCompStatements(e,t,r,i,a,n,s,p){_main.partialUpdateConfig.partialUpdateMode?e.push(createComponentCreationStatement(r,t,p,i,a,n,s)):e.push(...t)}function createComponentCreationStatement(e,t,r,i=!1,a=!1,n=void 0,s=null){var p=[...t],n=(n&&p.push(processDebug(e,n,t,!0)),a||createInitRenderStatement(e,s,p),_main.partialUpdateConfig.optimizeComponent||(p.unshift(createViewStackProcessorStatement(_pre_define.STARTGETACCESSRECORDINGFOR,_pre_define.ELMTID)),p.push(createViewStackProcessorStatement(_pre_define.STOPGETACCESSRECORDING))),[_typescript.default.factory.createArrowFunction(void 0,void 0,[_typescript.default.factory.createParameterDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.ELMTID),void 0,void 0,void 0),_typescript.default.factory.createParameterDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER),void 0,void 0,void 0)],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock(p,!0))]);return _main.partialUpdateConfig.optimizeComponent&&n.push(a?_typescript.default.factory.createNull():_typescript.default.factory.createIdentifier(r)),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression((0,_process_custom_component.createConditionParent)(i),_typescript.default.factory.createIdentifier(_main.partialUpdateConfig.optimizeComponent?_pre_define.OBSERVECOMPONENTCREATION2:_pre_define.OBSERVECOMPONENTCREATION)),void 0,n))}function createViewStackProcessorStatement(e,t){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.VIEWSTACKPROCESSOR),_typescript.default.factory.createIdentifier(e)),void 0,t?[_typescript.default.factory.createIdentifier(_pre_define.ELMTID)]:[]))}function createInitRenderStatement(e,t,r){_main.partialUpdateConfig.optimizeComponent?t&&t.length&&r.push(_typescript.default.factory.createIfStatement(_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER),_typescript.default.factory.createBlock(t,!0))):r.push(_typescript.default.factory.createIfStatement(_typescript.default.factory.createPrefixUnaryExpression(_typescript.default.SyntaxKind.ExclamationToken,_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER)),_typescript.default.factory.createBlock([_typescript.default.isExpressionStatement(e)?createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode:createIfPop()],!0),t&&t.length?_typescript.default.factory.createBlock(t,!0):void 0))}function processItemComponent(e,t,r,i,a=!1,n=void 0){var s=[],p=[],o=[],c=createComponent(e,_pre_define.COMPONENT_CREATE_FUNCTION),d=checkLazyCreate(e,t),f=createItemCreate(t,d),f=(s.push(f),parseEtsComponentExpression(e));f.etsComponentNode.body&&_typescript.default.isBlock(f.etsComponentNode.body)?(f.hasAttr&&bindComponentAttr(e,c.identifierNode,s,i,!0,!1,p),processComponentChild(f.etsComponentNode.body,o,i,{isAcceleratePreview:!1,line:0,column:0,fileName:""},!1,void 0,void 0,a,!1)):bindComponentAttr(e,c.identifierNode,s,i,!0,!1,p);let _;_=n?ifRetakeId([createItemBlock(e,s,o,t,d,p)],n):createItemBlock(e,s,o,t,d,p),r.push(_)}function createItemCreate(e,t){var r=[];return t?r.push(_typescript.default.factory.createIdentifier(_pre_define.DEEPRENDERFUNCTION),_typescript.default.factory.createTrue()):r.push(_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([],!1)),_typescript.default.factory.createFalse()),r.push(...e.arguments),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(e.name),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),void 0,r))}function createItemBlock(e,t,r,i,a,n){t=[createItemCreation(e,t,i,n)];return a?t.push(createDeepRenderFunction(e,r),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.OBSERVECOMPONENTCREATION)),void 0,[_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION)])),createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode):t.push(createObservedDeepRender(e,r),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.OBSERVEDDEEPRENDER),void 0,[]))),_typescript.default.factory.createBlock(t,!0)}function checkLazyCreate(e,t){return t.name===_pre_define.LIST_ITEM&&!(t.arguments.length&&_typescript.default.isStringLiteral(t.arguments[0])&&"false"===t.arguments[0].text||isLazyForEachChild(e))}function createItemCreation(e,t,r,i){return _typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION),void 0,void 0,_typescript.default.factory.createArrowFunction(void 0,void 0,[_typescript.default.factory.createParameterDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.ELMTID),void 0,void 0,void 0),_typescript.default.factory.createParameterDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER),void 0,void 0,void 0)],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([createViewStackProcessorStatement(_pre_define.STARTGETACCESSRECORDINGFOR,_pre_define.ELMTID),...t,processDebug(e,r,t,!0),_typescript.default.factory.createIfStatement(_typescript.default.factory.createPrefixUnaryExpression(_typescript.default.SyntaxKind.ExclamationToken,_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER)),_typescript.default.factory.createBlock([createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode],!0),i&&i.length?_typescript.default.factory.createBlock(i,!0):void 0),createViewStackProcessorStatement(_pre_define.STOPGETACCESSRECORDING)],!0)))],_typescript.default.NodeFlags.Const))}function createDeepRenderFunction(e,t){return _typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define.DEEPRENDERFUNCTION),void 0,void 0,_typescript.default.factory.createArrowFunction(void 0,void 0,[_typescript.default.factory.createParameterDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.ELMTID),void 0,void 0,void 0),_typescript.default.factory.createParameterDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER),void 0,void 0,void 0)],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION),void 0,[_typescript.default.factory.createIdentifier(_pre_define.ELMTID),_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER)])),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.UPDATE_FUNC_BY_ELMT_ID)),_typescript.default.factory.createIdentifier(_pre_define.CREATE_SET_METHOD)),void 0,[_typescript.default.factory.createIdentifier(_pre_define.ELMTID),_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION)])),...t,createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode],!0)))],_typescript.default.NodeFlags.Const))}function createObservedDeepRender(e,t){return _typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define.OBSERVEDDEEPRENDER),void 0,void 0,_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.OBSERVECOMPONENTCREATION)),void 0,[_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION)])),...t,createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode],!0)))],_typescript.default.NodeFlags.Const))}function processTabAndNav(e,t,r,i,a=!1,n=void 0){var s=r.name,p=getEtsComponentExpression(e).body;let o;var c=_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(s),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION)),void 0,[])),d=[],f=[];let _;n&&(_=t.length),o=p&&p.statements.length?(processComponentChild(p,p=[],i),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(s),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),void 0,[_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([...p],!0))]))):_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(s),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),void 0,[])),bindComponentAttr(e,_typescript.default.factory.createIdentifier(s),d,i,!0,!1,f),processInnerCompStatements(t,[o,...d],e,a,!1,r,f,s),t.push(c),n&&t.splice(_,t.length-_,ifRetakeId(t.slice(_),n))}function getRealNodePos(e){return-1===e.pos&&e.expression?getRealNodePos(e.expression):e.getStart()}function processForEachComponent(t,e,r,i=!1,a=!1){var n=_typescript.default.factory.createExpressionStatement(createFunction(t.expression.expression,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null));if(_typescript.default.isCallExpression(t.expression)){var s=_typescript.default.factory.createPropertyAccessExpression(t.expression.expression,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),p=Array.from(t.expression.arguments);let e;p.length&&(e=_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.FOREACH_OBSERVED_OBJECT),_typescript.default.factory.createIdentifier(_pre_define.FOREACH_GET_RAW_OBJECT)),void 0,[p[0]])),p.splice(0,1,e);r=processForEachBlock(t.expression,r,i);r&&p.splice(1,1,r),t=addForEachId(_typescript.default.factory.updateExpressionStatement(t,_typescript.default.factory.updateCallExpression(t.expression,s,t.expression.typeArguments,p)),a)}e.push(t,n)}function processForEachComponentNew(e,t,r,i=!1){var a,n,s,p,o,c=[],d=_typescript.default.factory.createExpressionStatement(createFunction(e.expression.expression,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null));_typescript.default.isCallExpression(e.expression)&&(a=Array.from(e.expression.arguments),n=_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.expression.expression,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),void 0,[])),r=processForEachBlock(e.expression,r,!1,i),r=createItemGenFunctionStatement(e.expression,a,r),s=createItemIdFuncStatement(e.expression,a),p=createUpdateFunctionStatement(a,i),o=createLazyForEachStatement(a),e.expression.expression.getText()===_pre_define.COMPONENT_FOREACH?(c.push(n,r,p),t.push(createComponentCreationStatement(e,c,_pre_define.COMPONENT_FOREACH,i),d)):a[2]?t.push(_typescript.default.factory.createBlock([r,s,o,d],!0)):t.push(_typescript.default.factory.createBlock([r,o,d],!0)))}function createItemGenFunctionStatement(e,t,r){if(t[1]&&_typescript.default.isArrowFunction(t[1]))return _typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(e.expression.getText()===_pre_define.COMPONENT_FOREACH?_pre_define.FOREACHITEMGENFUNCTION:_pre_define.__LAZYFOREACHITEMGENFUNCTION),void 0,void 0,_typescript.default.factory.createArrowFunction(void 0,void 0,t[1].parameters&&1<=t[1].parameters.length?getParameters(t[1]):[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock(t[1].parameters&&1<=t[1].parameters.length?isForEachItemGeneratorParam(t,r):r?[...r]:void 0,!0)))],_typescript.default.NodeFlags.Const))}function isForEachItemGeneratorParam(e,t){return[_typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(e[1].parameters[0]&&e[1].parameters[0].name.getText()),void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define._ITEM))],_typescript.default.NodeFlags.Const)),...t]}function getParameters(e){var t=[_typescript.default.factory.createParameterDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define._ITEM))];return e.parameters&&1<e.parameters.length&&t.push(e.parameters[1]),t}function createItemIdFuncStatement(e,t){if(t[2]&&_typescript.default.isArrowFunction(t[2]))return _typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(e.expression.getText()===_pre_define.COMPONENT_FOREACH?_pre_define.FOREACHITEMIDFUNC:_pre_define.__LAZYFOREACHITEMIDFUNC),void 0,void 0,t[2])],_typescript.default.NodeFlags.Const))}function createUpdateFunctionStatement(e,t=!1){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(t?parentConditionalExpression():_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.FOREACHUPDATEFUNCTION)),void 0,addForEachIdFuncParameter(e)))}function addForEachIdFuncParameter(e){var t=[];return t.push(_typescript.default.factory.createIdentifier(_pre_define.ELMTID),e[0],_typescript.default.factory.createIdentifier(_pre_define.FOREACHITEMGENFUNCTION)),e[1]&&e[1].parameters&&e[1].parameters[1]&&(e[2]?e[2].parameters&&e[2].parameters[1]?t.push(...addForEachParameter(e[2],_pre_define.TRUE,_pre_define.TRUE)):t.push(...addForEachParameter(e[2],_pre_define.TRUE,_pre_define.FALSE)):t.push(...addForEachParameter(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_IF_UNDEFINED),_pre_define.TRUE,_pre_define.FALSE))),e[1]&&!e[1].parameters[1]&&e[2]&&(e[2].parameters&&e[2].parameters[1]?t.push(...addForEachParameter(e[2],_pre_define.FALSE,_pre_define.TRUE)):t.push(...addForEachParameter(e[2],_pre_define.FALSE,_pre_define.FALSE))),t}function addForEachParameter(e,t,r){return[e,_typescript.default.factory.createIdentifier(t),_typescript.default.factory.createIdentifier(r)]}function createLazyForEachStatement(e){var t=[_typescript.default.factory.createStringLiteral(_utils.componentInfo.id.toString()),_typescript.default.factory.createThis(),e[0],_typescript.default.factory.createIdentifier(_pre_define.__LAZYFOREACHITEMGENFUNCTION)];return 3<=e.length&&e[2]&&t.push(_typescript.default.factory.createIdentifier(_pre_define.__LAZYFOREACHITEMIDFUNC)),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_LAZYFOREACH),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),void 0,t))}function addForEachId(e,t=!1){var r=e.expression;return _typescript.default.factory.updateExpressionStatement(e,_typescript.default.factory.updateCallExpression(r,r.expression,r.typeArguments,[_typescript.default.factory.createStringLiteral((++_utils.componentInfo.id).toString()),t?parentConditionalExpression():_typescript.default.factory.createThis(),...r.arguments]))}function parentConditionalExpression(){return _typescript.default.factory.createConditionalExpression(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_PARENT),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.QuestionToken),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_PARENT),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.ColonToken),_typescript.default.factory.createThis())}function processForEachBlock(e,t,r=!1,i=!1){if(1<e.arguments.length&&_typescript.default.isArrowFunction(e.arguments[1])){var a=e.expression.getText()===_pre_define.COMPONENT_LAZYFOREACH,n=e.arguments[1],s=n.body;if(!(2<e.arguments.length)||_typescript.default.isArrowFunction(e.arguments[2]))return _typescript.default.isBlock(s)?_main.partialUpdateConfig.partialUpdateMode?processComponentBlock(s,a,t,!1,!1,void 0,n.parameters,i).statements:_typescript.default.factory.updateArrowFunction(n,n.modifiers,n.typeParameters,n.parameters,n.type,n.equalsGreaterThanToken,processComponentBlock(s,a,t,!1,r,void 0,n.parameters)):(e=_typescript.default.factory.createExpressionStatement(s),r=_typescript.default.factory.createBlock([e],!0),e.parent=r,_main.partialUpdateConfig.partialUpdateMode?processComponentBlock(r,a,t,!1,!1,void 0,n.parameters).statements:_typescript.default.factory.updateArrowFunction(n,n.modifiers,n.typeParameters,n.parameters,n.type,n.equalsGreaterThanToken,processComponentBlock(r,a,t,!1,!1,void 0,n.parameters,i)));t.push({type:_utils.LogType.ERROR,message:"There should be wrapped in curly braces in ForEach.",pos:s.getStart()})}return null}function createRenderingInProgress(e){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createBinaryExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.IS_RENDERING_IN_PROGRESS)),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsToken),e?_typescript.default.factory.createTrue():_typescript.default.factory.createFalse()))}function processIfStatement(e,t,r,i=!1,a=!1){var n=createIfCreate(),r=processInnerIfStatement(e,0,r,i,a),i=createIfPop();_main.partialUpdateConfig.partialUpdateMode?t.push(createComponentCreationStatement(e,[n,r],_pre_define.COMPONENT_IF,a),i):t.push(n,r,i)}function processInnerIfStatement(e,t,r,i=!1,a=!1){_typescript.default.isIdentifier(e.expression)&&void 0===e.expression.originalKeywordKind&&!e.expression.escapedText&&(r.push({type:_utils.LogType.ERROR,message:"Condition expression cannot be null in if statement.",pos:e.expression.getStart()}),e=_typescript.default.factory.updateIfStatement(e,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_IF_UNDEFINED),e.thenStatement,e.elseStatement));var n=processThenStatement(e.thenStatement,t,r,i,a),t=processElseStatement(e.elseStatement,t,r,i,a);return _typescript.default.factory.updateIfStatement(e,e.expression,n,t)}function processThenStatement(e,t,r,i=!1,a=!1){return _typescript.default.isExpressionStatement(e)&&_typescript.default.isIdentifier(e.expression)&&void 0===e.expression.originalKeywordKind&&!e.expression.escapedText&&r.push({type:_utils.LogType.ERROR,message:"Then statement cannot be null in if statement.",pos:e.expression.getStart()}),e=e&&(_typescript.default.isBlock(e)?processIfBlock(e,t,r,i,a):_typescript.default.isIfStatement(e)?(e=processInnerIfStatement(e,0,r,i,a),_typescript.default.factory.createBlock(_main.partialUpdateConfig.partialUpdateMode?[createIfCreate(),createIfBranchFunc(t,[e],a),createIfPop()]:[createIfCreate(),createIfBranchId(t),e,createIfPop()],!0)):processIfBlock(e=_typescript.default.factory.createBlock([e],!0),t,r,i,a))}function processElseStatement(e,t,r,i=!1,a=!1){return e?e=_typescript.default.isBlock(e)?processIfBlock(e,t+1,r):_typescript.default.isIfStatement(e)?processInnerIfStatement(e,t+1,r,i,a):processIfBlock(e=_typescript.default.factory.createBlock([e],!0),t+1,r,i,a):_main.partialUpdateConfig.partialUpdateMode&&(e=_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.IFELSEBRANCHUPDATEFUNCTION)),void 0,[_typescript.default.factory.createNumericLiteral(++t),_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([],!0))]))],!0)),e}function processIfBlock(e,t,r,i=!1,a=!1){return addIfBranchId(t,a,processComponentBlock(e,!1,r,!1,i,_pre_define.COMPONENT_IF,void 0,a))}function addIfBranchId(e,t=!1,r){let i;return i=_main.partialUpdateConfig.partialUpdateMode?[createIfBranchFunc(e,[...r.statements],t)]:[createIfBranchId(e),...r.statements],_typescript.default.factory.updateBlock(r,i)}function createIf(){return _typescript.default.factory.createIdentifier(_pre_define.COMPONENT_IF)}function createIfCreate(){return _typescript.default.factory.createExpressionStatement(createFunction(createIf(),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),_typescript.default.factory.createNodeArray([])))}function createIfPop(){return _typescript.default.factory.createExpressionStatement(createFunction(createIf(),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null))}function createIfBranchId(e){return _typescript.default.factory.createExpressionStatement(createFunction(createIf(),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_IF_BRANCH_ID_FUNCTION),_typescript.default.factory.createNodeArray([_typescript.default.factory.createNumericLiteral(e)])))}function createIfBranchFunc(e,t,r=!1){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(r?parentConditionalExpression():_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.IFELSEBRANCHUPDATEFUNCTION)),void 0,[_typescript.default.factory.createNumericLiteral(e),_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock(t,!0))]))}function createComponent(e,t){var r={newNode:e,identifierNode:null,isContainerComponent:!1,isButton:!1,needPop:!1};let i=_typescript.default.factory.createIdentifier(t),a=e.expression;for(;a&&!_typescript.default.isIdentifier(a)&&a.expression;)a=a.expression;return a&&a.parent&&(_typescript.default.isCallExpression(a.parent)||_typescript.default.isEtsComponentExpression(a.parent))&&_typescript.default.isIdentifier(a)&&(a.getText()===_pre_define.COMPONENT_BUTTON&&t!==_pre_define.COMPONENT_POP_FUNCTION&&(r.isButton=!0,i=t===_pre_define.COMPONENT_CREATE_CHILD_FUNCTION?_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_CHILD_FUNCTION):_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_LABEL_FUNCTION)),_component_map.NEEDPOP_COMPONENT.has(a.getText())&&(r.needPop=!0),checkContainer(a.getText(),a.parent)&&(r.isContainerComponent=!0),r.newNode=t===_pre_define.COMPONENT_POP_FUNCTION?_typescript.default.factory.createExpressionStatement(createFunction(a,i,null)):_typescript.default.factory.createExpressionStatement(createFunction(a,i,checkArguments(a,t))),r.identifierNode=a),r}function checkArguments(t,r){var i=this;const a=[];return _component_map.CUSTOM_BUILDER_CONSTRUCTORS.has(t.escapedText.toString())?(t.parent.arguments.forEach(function(e){_newArrowCheck(this,i),_typescript.default.isConditionalExpression(e)?a.push(processConditionalBuilder(e,t,r)):isBuilderChangeNode(e,t,r)?a.push(parseBuilderNode(e,r)):a.push(e)}.bind(this)),a):"XComponent"===t.getText()&&r===_pre_define.COMPONENT_CREATE_FUNCTION&&_main.projectConfig.moduleName&&_main.projectConfig.bundleName?t.parent.arguments.concat([_typescript.default.factory.createStringLiteral(_main.projectConfig.bundleName+"/"+_main.projectConfig.moduleName)]):t.parent.arguments}function checkContainer(e,t){return _component_map.BUILDIN_CONTAINER_COMPONENT.has(e)&&("XComponent"!==e||t&&t.arguments&&t.arguments.length&&_typescript.default.isObjectLiteralExpression(t.arguments[0])&&t.arguments[0].properties&&checkComponentType(t.arguments[0].properties))}function checkComponentType(e){var t=this;let r=!1;return e.forEach(function(e){_newArrowCheck(this,t),isXComponentContainer(e)&&(r=!0)}.bind(this)),r}function isXComponentContainer(e){return e.name&&_typescript.default.isIdentifier(e.name)&&e.name.getText()===_pre_define.RESOURCE_NAME_TYPE&&e.initializer&&(_typescript.default.isStringLiteral(e.initializer)&&(e.initializer.getText()===_pre_define.XCOMPONENT_SINGLE_QUOTATION||e.initializer.getText()===_pre_define.XCOMPONENT_DOUBLE_QUOTATION)||_typescript.default.isNumericLiteral(e.initializer)&&"1"===e.initializer.getText()||_typescript.default.isPropertyAccessExpression(e.initializer)&&e.initializer.expression&&_typescript.default.isIdentifier(e.initializer.expression)&&e.initializer.name&&_typescript.default.isIdentifier(e.initializer.name)&&e.initializer.expression.getText()===_pre_define.XCOMPONENTTYPE&&e.initializer.name.getText()===_pre_define.XCOMPONENTTYPE_CONTAINER)}function bindComponentAttr(e,r,t,i,a=!0,n=!1,s=null,p=!1,o=null){let c=e.expression;var d=[],f=[],_=[],l={statement:null,kind:!1,hasAnimationAttr:!1},u=(0,_process_custom_component.isRecycle)(_validate_ui_syntax.componentCollection.currentClassName);for(_typescript.default.isPropertyAccessExpression(c)&&i.push({type:_utils.LogType.ERROR,message:`'${e.getText()}' does not meet UI component syntax.`,pos:e.getStart()});c&&_typescript.default.isCallExpression(c)&&c.expression;){let t=!1;if(c.expression&&(validatePropertyAccessExpressionWithCustomBuilder(c.expression)||validateIdentifierWithCustomBuilder(c.expression))){let e="";switch(_typescript.default.isIdentifier(c.expression)?e=c.expression.escapedText.toString():_typescript.default.isPropertyAccessExpression(c.expression)&&(e=c.expression.name.escapedText.toString()),!0){case _pre_define.BIND_POPUP_SET.has(e):c=processBindPopupBuilder(c);break;case _pre_define.BIND_DRAG_SET.has(e):c=processDragStartBuilder(c,e);break;default:c=processCustomBuilderProperty(c,r,e)}t=!0}if(_typescript.default.isPropertyAccessExpression(c.expression)&&c.expression.name&&_typescript.default.isIdentifier(c.expression.name)&&!_validate_ui_syntax.componentCollection.customComponents.has(c.expression.name.getText()))parseRecycleId(c,c.expression.name,u,o),addComponentAttr(c,c.expression.name,l,d,r,i,n,f,_,s,u,p),c=c.expression.expression,t=!0;else if(_typescript.default.isIdentifier(c.expression)){_component_map.INNER_COMPONENT_NAMES.has(c.expression.getText())||_component_map.GESTURE_TYPE_NAMES.has(c.expression.getText())||_validate_ui_syntax.componentCollection.customComponents.has(c.expression.getText())||(parseRecycleId(c,c.expression.name,u,o),addComponentAttr(c,c.expression,l,d,r,i,n,f,_,s,u,p));break}t||(c=c.expression)}l.statement&&l.kind&&d.push(l.statement),!u||l.hasAnimationAttr?d.length&&(a?t.push(...d.reverse()):t.push(...d)):(_.length&&(a?t.push(..._.reverse()):t.push(..._)),s&&f.length&&(a?s.push(...f.reverse()):s.push(...f)))}function parseRecycleId(e,t,r,i){i&&t.escapedText.toString()===_pre_define.RECYCLE_REUSE_ID&&(i.reuseId=e.arguments[0])}function processCustomBuilderProperty(e,r,i){var a=this;const n=[];return e.arguments.forEach(function(e,t){_newArrowCheck(this,a),_typescript.default.isConditionalExpression(e)?n.push(processConditionalBuilder(e,r,i)):isBuilderChangeNode(e,r,i)?n.push(parseBuilderNode(e,i)):n.push(e)}.bind(this)),e=_typescript.default.factory.updateCallExpression(e,e.expression,e.typeArguments,n)}function isBuilderChangeNode(e,t,r){return _typescript.default.isPropertyAccessExpression(e)&&e.name&&_typescript.default.isIdentifier(e.name)&&_component_map.CUSTOM_BUILDER_METHOD.has(e.name.getText())||_typescript.default.isCallExpression(e)&&e.expression&&e.expression.name&&_typescript.default.isIdentifier(e.expression.name)&&_component_map.CUSTOM_BUILDER_METHOD.has(e.expression.name.getText())||_typescript.default.isIdentifier(e)&&e.escapedText&&_component_map.CUSTOM_BUILDER_METHOD.has(e.escapedText.toString())||_typescript.default.isObjectLiteralExpression(e)&&_pre_define.BIND_OBJECT_PROPERTY.get(t.escapedText.toString())&&_pre_define.BIND_OBJECT_PROPERTY.get(t.escapedText.toString()).has(r)||_typescript.default.isCallExpression(e)&&e.expression&&_typescript.default.isIdentifier(e.expression)&&_component_map.CUSTOM_BUILDER_METHOD.has(e.expression.escapedText.toString())}function parseBuilderNode(e,t){return isPropertyAccessExpressionNode(e)?(_component_map.CUSTOM_BUILDER_PROPERTIES_WITHOUTKEY.has(t)?processPropertyBuilderWithoutKey:processPropertyBuilder)(e):_typescript.default.isIdentifier(e)&&_component_map.CUSTOM_BUILDER_METHOD.has(e.escapedText.toString())?(_component_map.CUSTOM_BUILDER_PROPERTIES_WITHOUTKEY.has(t)?processIdentifierBuilderWithoutKey:processIdentifierBuilder)(e):_typescript.default.isCallExpression(e)?(_component_map.CUSTOM_BUILDER_PROPERTIES_WITHOUTKEY.has(t)?getParsedBuilderAttrArgumentWithParamsWithoutKey:getParsedBuilderAttrArgumentWithParams)(e):_typescript.default.isObjectLiteralExpression(e)?processObjectPropertyBuilder(e):void 0}function processObjectPropertyBuilder(e){var t=this;const r=[];return e.properties.forEach(function(e){_newArrowCheck(this,t),e.name&&_typescript.default.isIdentifier(e.name)&&[_pre_define.CUSTOM_DIALOG_CONTROLLER_BUILDER,_pre_define.HEADER,_pre_define.FOOTER,_pre_define.START,_pre_define.END].includes(e.name.escapedText.toString())&&e.initializer?isPropertyAccessExpressionNode(e.initializer)||_typescript.default.isIdentifier(e.initializer)&&_component_map.CUSTOM_BUILDER_METHOD.has(e.initializer.escapedText.toString())?r.push(_typescript.default.factory.updatePropertyAssignment(e,e.name,_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.initializer,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()]))):isGlobalBuilderCallExpressionNode(e.initializer)||isInnerBuilderCallExpressionNode(e.initializer)?r.push(transformBuilderCallExpression(e)):_typescript.default.isObjectLiteralExpression(e.initializer)?r.push(_typescript.default.factory.updatePropertyAssignment(e,e.name,processObjectPropertyBuilder(e.initializer))):r.push(e):r.push(e)}.bind(this)),_typescript.default.factory.updateObjectLiteralExpression(e,r)}function transformBuilderCallExpression(e){return _typescript.default.factory.updatePropertyAssignment(e,e.name,_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.initializer.expression,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis(),...e.initializer.arguments||[]]))}function isInnerBuilderCallExpressionNode(e){return _typescript.default.isCallExpression(e)&&e.expression&&isPropertyAccessExpressionNode(e.expression)}function isGlobalBuilderCallExpressionNode(e){return _typescript.default.isCallExpression(e)&&e.expression&&_typescript.default.isIdentifier(e.expression)&&_component_map.CUSTOM_BUILDER_METHOD.has(e.expression.escapedText.toString())}function isPropertyAccessExpressionNode(e){return _typescript.default.isPropertyAccessExpression(e)&&e.expression&&e.expression.kind===_typescript.default.SyntaxKind.ThisKeyword&&e.name&&_typescript.default.isIdentifier(e.name)&&_component_map.CUSTOM_BUILDER_METHOD.has(e.name.escapedText.toString())}function processBindPopupBuilder(e){var r=this;const i=[];return e.arguments.forEach(function(e,t){_newArrowCheck(this,r),1===t?i.push(processBindPopupBuilderProperty(e)):i.push(e)}.bind(this)),e=_typescript.default.factory.updateCallExpression(e,e.expression,e.typeArguments,i)}function processDragStartBuilder(t,r){var i=[];if(isNodeFunction(t)){for(let e=0;e<t.arguments[0].body.statements.length;e++){var a=t.arguments[0].body.statements[e];i.push(checkStatement(a,r))}t=_typescript.default.factory.updateCallExpression(t,t.expression,t.typeArguments,[_typescript.default.factory.updateArrowFunction(t.arguments[0],void 0,void 0,t.arguments[0].parameters,t.arguments[0].type,t.arguments[0].equalsGreaterThanToken,_typescript.default.factory.updateBlock(t.arguments[0].body,i))])}return t}function isNodeFunction(e){return e.arguments&&e.arguments.length&&_typescript.default.isArrowFunction(e.arguments[0])&&e.arguments[0].body&&_typescript.default.isBlock(e.arguments[0].body)}function checkStatement(t,r){if(_typescript.default.isReturnStatement(t)){var e;if(_typescript.default.isObjectLiteralExpression(t.expression)){var i=[];for(let e=0;e<t.expression.properties.length;e++){var a=checkProperty(t.expression.properties[e],r);i.push(a)}return _typescript.default.factory.createReturnStatement(_typescript.default.factory.createObjectLiteralExpression(i))}return e=processInitializer(e=t.expression,r),_typescript.default.factory.updateReturnStatement(t,e)}return t}function checkProperty(e,t){var r;return isPropertyFunction(e)&&(r=processInitializer(r=e.initializer,t),e=_typescript.default.factory.createPropertyAssignment(e.name,r)),e}function processInitializer(e,t){return e&&_typescript.default.isConditionalExpression(e)?processConditionalBuilder(e,_typescript.default.factory.createIdentifier(_pre_define.CUSTOM_COMPONENT_DEFAULT),t):isBuilderChangeNode(e,_typescript.default.factory.createIdentifier(_pre_define.CUSTOM_COMPONENT_DEFAULT),t)?parseBuilderNode(e,t):e}function isPropertyFunction(e){return _typescript.default.isPropertyAssignment(e)&&e.name&&_typescript.default.isIdentifier(e.name)&&e.name.escapedText.toString()===_pre_define.BUILDER_ATTR_NAME}function processBindPopupBuilderProperty(e){var i=this;const a=[];return e.properties.forEach(function(e,t){var r;_newArrowCheck(this,i),e.name&&_typescript.default.isIdentifier(e.name)&&e.initializer&&e.name.escapedText.toString()===_pre_define.CUSTOM_DIALOG_CONTROLLER_BUILDER?(r=processInitializer(r=e.initializer,_pre_define.BIND_POPUP),a.push(_typescript.default.factory.updatePropertyAssignment(e,e.name,r))):a.push(e)}.bind(this)),_typescript.default.factory.updateObjectLiteralExpression(e,a)}function processConditionalBuilder(e,t,r){let i=e.whenTrue,a=e.whenFalse;return isBuilderChangeNode(e.whenTrue,t,r)&&(i=parseBuilderNode(e.whenTrue,r)),isBuilderChangeNode(e.whenFalse,t,r)&&(a=parseBuilderNode(e.whenFalse,r)),_typescript.default.factory.createConditionalExpression(e.condition,e.questionToken,i,e.colonToken,a)}function processPropertyBuilder(e){return _typescript.default.factory.createObjectLiteralExpression([_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_NAME),_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()]))])}function processPropertyBuilderWithoutKey(e){return _typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()])}function processIdentifierBuilder(e){return _typescript.default.factory.createObjectLiteralExpression([_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_NAME),_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()]))])}function processIdentifierBuilderWithoutKey(e){return _typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()])}function getParsedBuilderAttrArgumentWithParams(e){return _typescript.default.factory.createObjectLiteralExpression([_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_NAME),_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.expression,_typescript.default.factory.createIdentifier(_pre_define.CALL)),void 0,[_typescript.default.factory.createThis(),...e.arguments]))],!0)))])}function getParsedBuilderAttrArgumentWithParamsWithoutKey(e){return _typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.expression,_typescript.default.factory.createIdentifier(_pre_define.CALL)),void 0,[_typescript.default.factory.createThis(),...e.arguments]))],!0))}function validatePropertyAccessExpressionWithCustomBuilder(e){return _typescript.default.isPropertyAccessExpression(e)&&e.name&&_typescript.default.isIdentifier(e.name)&&_component_map.CUSTOM_BUILDER_PROPERTIES.has(e.name.escapedText.toString())}function validateIdentifierWithCustomBuilder(e){return _typescript.default.isIdentifier(e)&&_component_map.CUSTOM_BUILDER_PROPERTIES.has(e.escapedText.toString())}function createArrowFunctionFor$$(e){return _typescript.default.factory.createArrowFunction(void 0,void 0,[_typescript.default.factory.createParameterDeclaration(void 0,void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.$$_NEW_VALUE),void 0,void 0,void 0)],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createBinaryExpression(e,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsToken),_typescript.default.factory.createIdentifier(_pre_define.$$_NEW_VALUE)))],!1))}function updateArgumentFor$$(e){return _typescript.default.isElementAccessExpression(e)?_typescript.default.factory.updateElementAccessExpression(e,updateArgumentFor$$(e.expression),e.argumentExpression):_typescript.default.isIdentifier(e)?(_compile_info.props.push(e.getText()),e.getText()===_pre_define.$$_THIS?_typescript.default.factory.createThis():e.getText().match(/^\$\$(.|\n)+/)?_typescript.default.factory.createIdentifier(e.getText().replace(/\$\$/,"")):void 0):_typescript.default.isPropertyAccessExpression(e)?_typescript.default.factory.updatePropertyAccessExpression(e,updateArgumentFor$$(e.expression),e.name):void 0}function verifyComponentId(e,t,r,i){var a,n,s;!newsupplement.isAcceleratePreview&&r===_pre_define.ATTRIBUTE_ID&&_typescript.default.isStringLiteral(e.arguments[0])&&(r=e.arguments[0].text,e=_process_ui_syntax.transformLog.sourceFile.getLineAndCharacterOfPosition(getRealNodePos(t)),a=_process_ui_syntax.transformLog.sourceFile.fileName.replace(/\.ts$/,""),a=_path.default.resolve(_main.projectConfig.projectPath,a).replace(/\\+/g,"/"),n=e.line+1,e=e.character+1,_component_map.ID_ATTRS.has(r)?(s=_component_map.ID_ATTRS.get(r)).get("path")===a&&s.get("line")===n&&s.get("col")===e||i.push({type:_utils.LogType.WARN,message:`The current component id "${r}" is duplicate with `+`${s.get("path")}:${s.get("line")}:${s.get("col")}.`,pos:t.pos}):_component_map.ID_ATTRS.set(r,(new Map).set("path",a).set("line",n).set("col",e)))}function addComponentAttr(t,e,r,i,a,n,s,p,o,c=null,d=!1,f=!1){var _=e.getText(),l=(verifyComponentId(t,e,_,n),{type:""});if(_===_pre_define.ATTRIBUTE_ANIMATION){var u=_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.GLOBAL_CONTEXT),e,[_typescript.default.factory.createNull()]));r.statement?i.push(r.statement,u):1===t.arguments.length&&t.arguments[0].kind===_typescript.default.SyntaxKind.NullKeyword||i.push(u),r.statement=_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.GLOBAL_CONTEXT),e,t.arguments)),r.kind=!1,r.hasAnimationAttr=!0}else if(_component_map.GESTURE_ATTRS.has(_))parseGesture(t,_,i,n,o),r.kind=!0;else if(isExtendFunctionNode(a,_,l)){newsupplement.isAcceleratePreview&&n.push({type:_utils.LogType.ERROR,message:"Doesn't support Extend function now",pos:t.getStart()});let e="";e=l.type===_pre_define.CHECK_COMPONENT_EXTEND_DECORATOR?`__${a.escapedText.toString()}__`+_:_;var u=_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(e),void 0,l.type===_pre_define.CHECK_COMPONENT_EXTEND_DECORATOR?t.arguments:[...t.arguments,_typescript.default.factory.createIdentifier(_pre_define.ELMTID),_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER),_typescript.default.factory.createThis()]));i.push(u),o.push(u),r.kind=!0}else _===_pre_define.ATTRIBUTE_STATESTYLES?1===t.arguments.length&&_typescript.default.isObjectLiteralExpression(t.arguments[0])?(i.push(createViewStackProcessor(t,!0)),d&&o.push(createViewStackProcessor(t,!0)),traverseStateStylesAttr(t,i,a,n,o,c,d),r.kind=!0):validateStateStyleSyntax(t,n):(_component_map.GLOBAL_STYLE_FUNCTION.has(_)||_component_map.INNER_STYLE_FUNCTION.has(_)?0<(l=_component_map.INNER_STYLE_FUNCTION.get(_)||_component_map.GLOBAL_STYLE_FUNCTION.get(_)).statements.length&&(bindComponentAttr(l.statements[0],a,i,n,!1,!0,c),d)&&bindComponentAttr(l.statements[0],a,o,n,!1,!0,c,!0):isDoubleDollarToChange(s,a,_,t)?(classifyArgumentsNum(t.arguments,u=[],_,a),l=_typescript.default.factory.createExpressionStatement(createFunction(a,e,u)),i.push(l),o.push(l)):(s&&!_component_map.COMMON_ATTRS.has(_)&&validateStateStyleSyntax(t,n),t=loopEtscomponent(t,s),_!==_pre_define.RECYCLE_REUSE_ID&&(c=_typescript.default.factory.createExpressionStatement(createFunction(a,e,t.arguments)),i.push(c),(!d||s&&!f||isGestureType(a)||!filterRegularAttrNode(t.arguments)?o:p).push(c))),r.kind=!0)}function isGestureType(e){return _component_map.GESTURE_TYPE_NAMES.has(e.escapedText.toString())}function filterRegularAttrNode(e){var t=this;return e.every(function(e){return _newArrowCheck(this,t),isRegularAttrNode(e)}.bind(this))}function isRegularAttrNode(e){var t=this;if(_typescript.default.isObjectLiteralExpression(e))return e.properties.every(function(e){return _newArrowCheck(this,t),!!e.initializer&&isRegularAttrNode(e.initializer)}.bind(this));if(_typescript.default.isArrayLiteralExpression(e))return e.elements.every(function(e){return _newArrowCheck(this,t),isRegularAttrNode(e)}.bind(this));if(isLiteralNode(e))return!0;if(_typescript.default.isPropertyAccessExpression(e)&&_typescript.default.isIdentifier(e.expression)&&_typescript.default.isIdentifier(e.name)){if(_validate_ui_syntax.enumCollection.has(e.expression.escapedText.toString()))return!0;if(_main.globalProgram.checker)if(1056&_main.globalProgram.checker.getTypeAtLocation(e).flags)return!0;return!1}var r={isRegularNode:!1};return _typescript.default.isPropertyAccessExpression(e)&&traversePropNode(e,r),r.isRegularNode||!1}function isLiteralNode(e){return _typescript.default.isStringLiteral(e)||_typescript.default.isNumericLiteral(e)||_typescript.default.isArrowFunction(e)||[_typescript.default.SyntaxKind.TrueKeyword,_typescript.default.SyntaxKind.FalseKeyword].includes(e.kind)}function traversePropNode(e,t){e.expression.kind===_typescript.default.SyntaxKind.ThisKeyword&&_typescript.default.isIdentifier(e.name)&&_validate_ui_syntax.regularCollection.get(_validate_ui_syntax.componentCollection.currentClassName).has(e.name.escapedText.toString())?t.isRegularNode=!0:_typescript.default.isPropertyAccessExpression(e.expression)&&traversePropNode(e.expression,t)}function isDoubleDollarToChange(e,t,r,i){return!!(!e&&_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.has(t.escapedText.toString())&&_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.get(t.escapedText.toString()).has(r)||_pre_define.STYLE_ADD_DOUBLE_DOLLAR.has(r)&&i.arguments.length&&i.arguments[0])&&null!==i.arguments[0].getText().match(/^\$\$(.|\n)+/)}function isHaveDoubleDollar(e,t){return _typescript.default.isPropertyAssignment(e)&&e.name&&_typescript.default.isIdentifier(e.name)&&_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.get(t).has(e.name.getText())&&e.initializer&&e.initializer.getText().startsWith(_pre_define.$$)}function loopEtscomponent(r,e){var i=this;return r.arguments.forEach(function(e,t){_newArrowCheck(this,i),_typescript.default.isEtsComponentExpression(e)?r.arguments[t]=_typescript.default.factory.createCallExpression(e.expression,void 0,e.arguments):!_typescript.default.isCallExpression(e)&&!_typescript.default.isNewExpression(e)||newsupplement.isAcceleratePreview||(r.arguments[t]=_typescript.default.visitEachChild(e,changeEtsComponentKind,_process_ui_syntax.contextGlobal))}.bind(this)),r}function changeEtsComponentKind(e){return _typescript.default.isEtsComponentExpression(e)?(e.kind=204,e):_typescript.default.visitEachChild(e,changeEtsComponentKind,_process_ui_syntax.contextGlobal)}function classifyArgumentsNum(e,t,r,i){var a;_pre_define.STYLE_ADD_DOUBLE_DOLLAR.has(r)&&2<=e.length?(a=updateArgumentFor$$(e[0]),t.push(generateObjectFor$$(a),...e.slice(1))):(_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.has(i.getText())&&1===e.length&&_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.get(i.getText()).has(r)||_pre_define.STYLE_ADD_DOUBLE_DOLLAR.has(r)&&1===e.length)&&(a=updateArgumentFor$$(e[0]),t.push(a,createArrowFunctionFor$$(a)))}function generateObjectFor$$(e){return _typescript.default.factory.createObjectLiteralExpression([_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.$$_VALUE),e),_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.$$_CHANGE_EVENT),createArrowFunctionFor$$(e))],!1)}function createViewStackProcessor(e,t){var r=[];return!t&&e.name&&r.push(_typescript.default.factory.createStringLiteral(e.name.getText())),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.VIEW_STACK_PROCESSOR),_typescript.default.factory.createIdentifier(_pre_define.VISUAL_STATE)),void 0,r))}function traverseStateStylesAttr(r,i,a,n,s,p=null,o=!1){var c=this;r.arguments[0].properties.reverse().forEach(function(e){var t;_newArrowCheck(this,c),_typescript.default.isPropertyAccessExpression(e.initializer)&&e.initializer.expression.getText()===_pre_define.THIS&&_component_map.INNER_STYLE_FUNCTION.get(e.initializer.name.getText())?(t=e.initializer.name.getText(),bindComponentAttr(_component_map.INNER_STYLE_FUNCTION.get(t).statements[0],a,i,n,!1,!0,p),o&&bindComponentAttr(_component_map.INNER_STYLE_FUNCTION.get(t).statements[0],a,s,n,!1,!0,p)):_typescript.default.isIdentifier(e.initializer)&&_component_map.GLOBAL_STYLE_FUNCTION.get(e.initializer.getText())?(t=e.initializer.getText(),bindComponentAttr(_component_map.GLOBAL_STYLE_FUNCTION.get(t).statements[0],a,i,n,!1,!0,p),o&&bindComponentAttr(_component_map.GLOBAL_STYLE_FUNCTION.get(t).statements[0],a,s,n,!1,!0,p)):_typescript.default.isObjectLiteralExpression(e.initializer)&&1===e.initializer.properties.length&&_typescript.default.isPropertyAssignment(e.initializer.properties[0])?(bindComponentAttr(_typescript.default.factory.createExpressionStatement(e.initializer.properties[0].initializer),a,i,n,!1,!0,p),o&&bindComponentAttr(_typescript.default.factory.createExpressionStatement(e.initializer.properties[0].initializer),a,s,n,!1,!0,p)):_typescript.default.isObjectLiteralExpression(e.initializer)&&0===e.initializer.properties.length||validateStateStyleSyntax(r,n),e.name&&(t=createViewStackProcessor(e,!1),i.push(t),o)&&s.push(t)}.bind(this))}function isExtendFunctionNode(e,t,r){var i,e=e.escapedText.toString();return _component_map.EXTEND_ATTRIBUTE.has(e)&&[..._component_map.EXTEND_ATTRIBUTE.get(e)].includes(t)?(r.type=_pre_define.CHECK_COMPONENT_EXTEND_DECORATOR,!0):!(!(i=_utils.storedFileInfo.getCurrentArkTsFile().animatableExtendAttribute).has(e)||![...i.get(e)].includes(t)||(r.type=_pre_define.CHECK_COMPONENT_ANIMATABLE_EXTEND_DECORATOR,0))}const gestureMap=new Map([[_pre_define.PRIORITY_GESTURE_ATTRIBUTE,_pre_define.GESTURE_ENUM_VALUE_HIGH],[_pre_define.PARALLEL_GESTURE_ATTRIBUTE,_pre_define.GESTURE_ENUM_VALUE_PARALLEL],[_pre_define.GESTURE_ATTRIBUTE,_pre_define.GESTURE_ENUM_VALUE_LOW]]);function parseGesture(e,t,r,i,a){var n=_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_GESTURE),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null)),n=(r.push(n),a.push(n),parseGestureInterface(e,r,i,a),_typescript.default.factory.createNodeArray([_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.GESTURE_ENUM_KEY),_typescript.default.factory.createIdentifier(gestureMap.get(t)))])),i=(e.arguments&&1<e.arguments.length&&_typescript.default.isPropertyAccessExpression(e.arguments[1])&&n.push(e.arguments[1]),_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_GESTURE),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),n)));r.push(i),a.push(i)}function processGestureType(t,e,r,i,a=!1){var n=[],s=_typescript.default.factory.createExpressionStatement(t);let p=t.expression;for(;p&&!_typescript.default.isIdentifier(p)&&p.expression;)p=p.expression;if(p&&p.parent&&_typescript.default.isCallExpression(p.parent)&&_typescript.default.isIdentifier(p)&&_component_map.GESTURE_TYPE_NAMES.has(p.escapedText.toString()))if(n.push(_typescript.default.factory.createExpressionStatement(createFunction(p,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null))),p.escapedText.toString()===_pre_define.COMPONENT_GESTURE_GROUP){t=[];parseGestureInterface(p.parent,t,r,i,!0),n.push(...t.reverse()),bindComponentAttr(s,p,n,r,!1);let e=null;p.parent.arguments&&p.parent.arguments.length&&(e=_typescript.default.factory.createNodeArray([p.parent.arguments[0]])),n.push(_typescript.default.factory.createExpressionStatement(createFunction(p,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),e)))}else bindComponentAttr(s,p,n,r,!1),n.push(_typescript.default.factory.createExpressionStatement(createFunction(p,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),p.parent.arguments)));n.length&&(a?e.push(...n.reverse()):e.push(...n),a?i.push(...n.reverse()):i.push(...n))}function parseGestureInterface(e,t,r,i,a=!1){var n=this;e.arguments&&e.arguments.length&&e.arguments.forEach(function(e){_newArrowCheck(this,n),_typescript.default.isCallExpression(e)&&processGestureType(e,t,r,i,a)}.bind(this))}function getName(e){let t=e.expression,r;for(;t;){if(_typescript.default.isIdentifier(t)&&t.parent&&(_typescript.default.isCallExpression(t.parent)||_typescript.default.isEtsComponentExpression(t.parent))){r=t.escapedText.toString();break}if(_typescript.default.isPropertyAccessExpression(t)&&t.name&&_typescript.default.isIdentifier(t.name)&&isCustomAttributes(t)){r=t.name.escapedText.toString();break}t=t.expression}return r}function isCustomAttributes(e){return!(!e.expression||e.expression.getText()!==_pre_define.THIS)||!!(e.expression&&_typescript.default.isIdentifier(e.expression)&&e.expression.getText()===_pre_define.$$&&_process_ui_syntax.builderTypeParameter.params.includes(e.expression.getText()))||!_component_map.BUILDIN_STYLE_NAMES.has(e.name.escapedText.toString())}function isAttributeNode(e){let t=e.expression,r;for(;t;){if(_typescript.default.isCallExpression(t)&&t.expression&&_typescript.default.isIdentifier(t.expression)){r=t.expression.escapedText.toString();break}t=t.expression}return _component_map.BUILDIN_STYLE_NAMES.has(r)}var ComponentType=function(e){return e[e.innerComponent=0]="innerComponent",e[e.customComponent=1]="customComponent",e[e.forEachComponent=2]="forEachComponent",e[e.customBuilderMethod=3]="customBuilderMethod",e[e.builderParamMethod=4]="builderParamMethod",e[e.function=5]="function",e[e.builderTypeFunction=6]="builderTypeFunction",e}(ComponentType||{});function isEtsComponent(e){let t=!1,r=e.expression;for(;r;)_typescript.default.isEtsComponentExpression(r)&&(t=!0),r=r.expression;return t}function isSomeName(e,t){var r=this;return Array.isArray(e)&&e.some(function(e){return _newArrowCheck(this,r),!!_typescript.default.isIdentifier(e.name)&&e.name.escapedText.toString()===t}.bind(this))}function isParamFunction(e){return e.expression&&_typescript.default.isCallExpression(e.expression)&&e.expression.expression&&_typescript.default.isIdentifier(e.expression.expression)}function getComponentType(e,t,r,i,a=void 0){let n=!0;return a&&isSomeName(a,r)&&isParamFunction(e)&&(n=!1),isEtsComponent(e)?_validate_ui_syntax.componentCollection.customComponents.has(r)?ComponentType.customComponent:ComponentType.innerComponent:_validate_ui_syntax.componentCollection.customComponents.has(r)?ComponentType.customComponent:r===_pre_define.COMPONENT_FOREACH||r===_pre_define.COMPONENT_LAZYFOREACH?ComponentType.forEachComponent:_component_map.CUSTOM_BUILDER_METHOD.has(r)&&n?ComponentType.customBuilderMethod:_validate_ui_syntax.builderParamObjectCollection.get(_validate_ui_syntax.componentCollection.currentClassName)&&_validate_ui_syntax.builderParamObjectCollection.get(_validate_ui_syntax.componentCollection.currentClassName).has(r)?ComponentType.builderParamMethod:!_main.partialUpdateConfig.builderCheck&&_process_ui_syntax.builderTypeParameter.params.includes(r)&&judgeBuilderType(e)?ComponentType.builderTypeFunction:(["XComponent"].includes(i)||_component_map.CUSTOM_BUILDER_METHOD.has(i))&&_typescript.default.isCallExpression(e.expression)&&_typescript.default.isIdentifier(e.expression.expression)?ComponentType.function:(isAttributeNode(e)||t.push({type:_utils.LogType.ERROR,message:`'${e.getText()}' does not meet UI component syntax.`,pos:e.getStart()}),null)}function judgeBuilderType(e){let t;if(_main.globalProgram.program?t=_main.globalProgram.program.getTypeChecker():_main.globalProgram.watchProgram&&(t=_main.globalProgram.watchProgram.getCurrentProgram().getProgram().getTypeChecker()),e.expression&&e.expression.expression&&t){e=t.getTypeAtLocation(e.expression.expression);if(e&&e.aliasSymbol&&e.aliasSymbol.escapedName===_pre_define.BUILDER_TYPE)return!0}return!1}function validateStateStyleSyntax(e,t){t.push({type:_utils.LogType.ERROR,message:".stateStyles doesn't conform standard.",pos:e.getStart()})}function getEtsComponentExpression(e){let t=e.expression;for(;t;){if(_typescript.default.isEtsComponentExpression(t))return t;t=t.expression}return null}function checkEtsAndIdInIf(e,t){let r=e.expression,i;for(;r&&!_typescript.default.isEtsComponentExpression(r);)!i&&t===_pre_define.COMPONENT_IF&&_typescript.default.isPropertyAccessExpression(r)&&r.name&&_typescript.default.isIdentifier(r.name)&&r.name.escapedText.toString()===_pre_define.ATTRIBUTE_ID&&r.parent&&r.parent.arguments&&r.parent.arguments.length&&(i=r.parent.arguments[0]),r=r.expression;return[r,i]}function checkIdInIf(e,t){let r=e.expression,i;for(;r;){if(t===_pre_define.COMPONENT_IF&&_typescript.default.isPropertyAccessExpression(r)&&r.name&&_typescript.default.isIdentifier(r.name)&&r.name.escapedText.toString()===_pre_define.ATTRIBUTE_ID&&r.parent&&r.parent.arguments&&r.parent.arguments.length){i=r.parent.arguments[0];break}r=r.expression}return i}function checkEtsComponent(e,t){e=getEtsComponentExpression(e);e&&(0,_validate_ui_syntax.checkAllNode)(e,new Set([..._component_map.INNER_COMPONENT_NAMES,..._validate_ui_syntax.componentCollection.customComponents]),_process_ui_syntax.transformLog.sourceFile,t)}function checkButtonParamHasLabel(t,r){if(t.arguments&&0!==t.arguments.length)for(let e=0;e<t.arguments.length;e++){var i=t.arguments[e];if(_typescript.default.isStringLiteral(i)||_typescript.default.isCallExpression(i)&&_typescript.default.isIdentifier(i.expression)&&i.expression.escapedText.toString()===_pre_define.RESOURCE)return void r.push({type:_utils.LogType.ERROR,message:"The Button component with a label parameter can not have any child.",pos:t.getStart()})}}function isLazyForEachChild(e){let t=e.parent;for(;t&&!_typescript.default.isEtsComponentExpression(t)&&!_typescript.default.isCallExpression(t);)t=t.parent;return!(!t||!t.expression||t.expression.escapedText.toString()!==_pre_define.COMPONENT_LAZYFOREACH)}function processDollarEtsComponent(e,n){var r=this;const s=[];return e.forEach(function(e,t){var i=this;if(_newArrowCheck(this,r),_typescript.default.isObjectLiteralExpression(e)&&e.properties&&e.properties.length){const a=[];e.properties.forEach(function(e,t){var r;_newArrowCheck(this,i),isHaveDoubleDollar(e,n)?(r=updateArgumentFor$$(e.initializer),a.push(_typescript.default.factory.updatePropertyAssignment(e,e.name,generateObjectFor$$(r)))):a.push(e)}.bind(this)),s.push(_typescript.default.factory.updateObjectLiteralExpression(e,a))}else s.push(e)}.bind(this)),s}function createFunction(e,t,r){var i;return r&&r.length?(i=e.escapedText.toString(),t.escapedText.toString()===_pre_define.COMPONENT_CREATE_FUNCTION&&_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.has(i)&&(r=processDollarEtsComponent(r,i)),checkCreateArgumentBuilder(e,t)&&(r=transformBuilder(r))):r=[],_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e,t),void 0,r)}function checkCreateArgumentBuilder(e,t){return!(t.escapedText.toString()!==_pre_define.COMPONENT_CREATE_FUNCTION||!_pre_define.CREATE_BIND_COMPONENT.has(e.escapedText.toString()))}function transformBuilder(e){var t=this;const r=[];return e.forEach(function(e){_newArrowCheck(this,t),r.push(parseCreateParameterBuilder(e))}.bind(this)),r}function parseCreateParameterBuilder(e){return _typescript.default.isObjectLiteralExpression(e)?processObjectPropertyBuilder(e):e}