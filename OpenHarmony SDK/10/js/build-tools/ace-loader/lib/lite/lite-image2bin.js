"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),Jimp=require("jimp"),fs=require("fs"),_path=require("path");function img2bin(e){return _img2bin.apply(this,arguments)}function _img2bin(){return(_img2bin=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function e(t){var r,a,n,i,p;return _regenerator.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Jimp.read(t);case 3:i=e.sent,r=i.bitmap.width*i.bitmap.height*4,r=new ArrayBuffer(8+r),a=new DataView(r),p=(i.bitmap.width<<0)+(i.bitmap.height<<16),n=0,a.setUint32(n,256,!0),n+=4,a.setUint32(n,p,!0),n+=4,i.scan(0,0,i.bitmap.width,i.bitmap.height,function(e,t,r){var i=this.bitmap.data[r+2],i=(a.setUint8(n,i,!0),n+=1,this.bitmap.data[r+1]),i=(a.setUint8(n,i,!0),n+=1,this.bitmap.data[r+0]),i=(a.setUint8(n,i,!0),n+=1,this.bitmap.data[r+3]);a.setUint8(n,i,!0),n+=1}),process.env.PLATFORM_VERSION_VERSION<=6&&(p=t.replace(/(\.png|\.jpg|\.bmp|\.jpeg|\.BMP|\.JPG|\.PNG|\.JPEG)$/,".bin"),fs.writeFileSync(p,Buffer.from(r))),i=t+".bin",fs.writeFileSync(i,Buffer.from(r)),e.next=30;break;case 25:throw e.prev=25,e.t0=e.catch(0),p=_path.basename(t),console.error("[31m","Failed to convert image ".concat(p,"."),"[39m"),e.t0;case 30:case"end":return e.stop()}},e,null,[[0,25]])}))).apply(this,arguments)}module.exports=img2bin;