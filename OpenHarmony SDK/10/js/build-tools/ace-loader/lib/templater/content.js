var parser=require("@babel/parser"),traverse=require("@babel/traverse").default,generate=require("@babel/generator").default;function parseExpression(r,t){const n=new RegExp(`^(NaN\\b|isNaN\\b|isFinite\\b|decodeURI\\b|decodeURIComponent\\b|Math\\b|Date\\b|this\\b|true\\b|false\\b|
    encodeURI\\b|encodeURIComponent\\b|parseInt\\b|parseFloat\\b|null\\b|undefined\\b|Infinity\\b)`,"g");var b=new RegExp(`^(var\\b|while\\b|with\\b|yield\\b|enum\\b|await\\b|implements\\b|package\\b|for\\b|function\\b|if\\b|import\\b|
    protected\\b|static\\b|interface\\b|private\\b|public\\b|break\\b|case\\b|class\\b|catch\\b|const\\b|continue\\b|debugger\\b|
    default\\b|delete\\b|do\\b|else\\b|export\\b|extends\\b|finally\\b|in\\b|instanceof\\b|let\\b|return\\b|super\\b|switch\\b|throw\\b|try\\b)`,"g"),e=new RegExp(`^(var\\b|while\\b|with\\b|yield\\b|enum\\b|await\\b|implements\\b|package\\b|for\\b|function\\b|if\\b|import\\b|
    protected\\b|static\\b|interface\\b|private\\b|public\\b|break\\b|case\\b|class\\b|catch\\b|const\\b|continue\\b|debugger\\b|
    default\\b|delete\\b|do\\b|else\\b|export\\b|extends\\b|finally\\b|in\\b|instanceof\\b|let\\b|return\\b|super\\b|switch\\b|throw\\b|try\\b|show\\b|tid\\b)$`,"g");try{if(e.test(r))throw Error("A data binding parsing error occurred. Do not use the reserved:"+r).message;var a=t?parser.parse("("+r+")"):parser.parse(r);return traverse(a,{enter(r){if(r.parent&&"Identifier"===r.node.type){let e=!1;(e=!!(["ConditionalExpression","BinaryExpression"].includes(r.parent.type)||"CallExpression"===r.parent.type&&r.parent.callee===r.node)||"ObjectProperty"===r.parent.type&&!r.parent.computed&&r.parent.value===r.node||addPrefix(r.node,r.parent))&&!n.test(r.node.name)&&(r.node.name="this."+r.node.name)}}}),generate(a,{compact:!0}).code.replace(";","").replace(/\"/g,"'").replace(/\n/g,"")}catch(e){throw(t?b.test(r)?Error("An event parsing error occurred. Do not use the reserved:"+r):Error("An event parsing error occurred:"+r):b.test(r)?Error("A data binding parsing error occurred. Do not use the reserved:"+r):Error("A data binding parsing error occurred:"+r)).message}}function addPrefix(r,t){var n=["expression","argument","arguments","expressions","elements","left","right"],b=["object","property","id","key"],a=Object.keys(t);for(let e=0;e<n.length;e++)if(a.includes(n[e])){if(t[n[e]]===r||["expressions","elements"].includes(n[e])&&t[n[e]].includes(r))return!0;if("arguments"===n[e]&&"Identifier"===t.arguments[0].type)return!0}for(let e=0;e<b.length;e++)if(a.includes(b[e])){if(t.computed&&t[b[e]]===r)return!0;if("Property"===t.type&&t.key.range[0]===t.value.range[0]&&t.key.range[1]===t.value.range[1])r.name=r.name+":this."+r.name;else if(t.object===r)return!0}return!1}exports.parseExpression=parseExpression;