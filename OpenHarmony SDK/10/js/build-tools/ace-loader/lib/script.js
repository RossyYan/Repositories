"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_path=_interopRequireDefault(require("path")),_util=require("./util"),_parser=require("./parser"),_require=require("./lite/lite-enum"),DEVICE_LEVEL=_require.DEVICE_LEVEL;module.exports=function(e,r){var t=this,n=(this.cacheable&&this.cacheable(),this.async());(0,_parser.parseScript)(e,this.resourcePath).then(function(e){var a=e.parsed,e=e.log;e&&e.length&&(0,_util.logWarn)(t,e),a=(0,_util.parseRequireModule)(a,t.resourcePath),process.env.DEVICE_LEVEL!==DEVICE_LEVEL.RICH&&"card"!==process.env.DEVICE_LEVEL||(e="page"===process.env.abilityType?"app.js":"".concat(process.env.abilityType,".js"),_path.default.basename(t.resourcePath)!==e&&(a+="\nvar moduleOwn = exports.default || module.exports;\nvar accessors = ['public', 'protected', 'private'];\nif (moduleOwn.data && accessors.some(function (acc) {\n    return moduleOwn[acc];\n  })) {\n  throw new Error('For VM objects, attribute data must not coexist with public, protected, or private. Please replace data with public.');\n} else if (!moduleOwn.data) {\n  moduleOwn.data = {};\n  moduleOwn._descriptor = {};\n  accessors.forEach(function(acc) {\n    var accType = typeof moduleOwn[acc];\n    if (accType === 'object') {\n      moduleOwn.data = Object.assign(moduleOwn.data, moduleOwn[acc]);\n      for (var name in moduleOwn[acc]) {\n        moduleOwn._descriptor[name] = {access : acc};\n      }\n    } else if (accType === 'function') {\n      console.warn('For VM objects, attribute ' + acc + ' value must not be a function. Change the value to an object.');\n    }\n  });\n}"),e="module.exports = function(module, exports, $app_require$){".concat(a,"}"),n(null,e+="\n/* generated by ace-loader */\n",r)),process.env.DEVICE_LEVEL===DEVICE_LEVEL.LITE&&n(null,a,r)}).catch(function(e){(0,_util.logWarn)(t,[{reason:"ERROR: Failed to parse the JS file. "+e}]),n("")})};